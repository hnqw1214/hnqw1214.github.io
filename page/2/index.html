<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="acmclub.win">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="acmclub.win">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="acmclub.win">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>acmclub.win</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">acmclub.win</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-/"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-/archives"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/HDU3430-（置换群循环节-中国剩余定理）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/HDU3430-（置换群循环节-中国剩余定理）/" itemprop="url">
                  HDU3430 （置换群循环节+中国剩余定理）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T17:59:48+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>题意：给出n张牌，标号为1-n，然后给出两个序列，序列1表示序列1,2,3,4……,n洗一次牌后到达的,序列2表示目标序列，问初始序列按序列1的洗牌方式洗几次能到达序列2的情况，如果不能到达输出-1。</p>
<p>题解：在初始序列和序列1的变换中找出1能变到那些牌，这些牌构成一个集合，这些集合中的牌必然是能够相互到达的，然后在序列2中也找出这样一个集合，集合中这些元素的相互顺序是要一样的，这就是判断能否达到，然后这样可以列出几个线性同余方程组，用中国剩余定理求解即可（顺便献上中国剩余定理模板）。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n,a[<span class="number">1001</span>],b[<span class="number">1001</span>],vis[<span class="number">1001</span>],c[<span class="number">1001</span>],x[<span class="number">1001</span>],y[<span class="number">1001</span>];</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a,<span class="keyword">long</span> <span class="keyword">long</span> b,<span class="keyword">long</span> <span class="keyword">long</span> &amp;x,<span class="keyword">long</span> <span class="keyword">long</span> &amp;y)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (b==<span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        x=<span class="number">1</span>;</div><div class="line">        y=<span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> a;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> gcd=exgcd(b,a%b,x,y);</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> t=x;</div><div class="line">    x=y;</div><div class="line">    y=t-a/b*x;</div><div class="line">    <span class="keyword">return</span> gcd;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">china_remain</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> m,<span class="keyword">int</span> a[],<span class="keyword">int</span> b[])</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//for (int i=1;i&lt;=m;i++)</span></div><div class="line">    <span class="comment">//    cout&lt;&lt;a[i]&lt;&lt;" "&lt;&lt;b[i]&lt;&lt;endl;</span></div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> a1,a2,b1,b2,x,y,flag=<span class="number">0</span>;</div><div class="line">    a1=a[<span class="number">0</span>];</div><div class="line">    b1=b[<span class="number">0</span>];</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;m;i++)</div><div class="line">    &#123;</div><div class="line">        a2=a[i];</div><div class="line">        b2=b[i];</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> gcd=exgcd(a1,a2,x,y);</div><div class="line">        <span class="keyword">if</span> ((b2-b1)%gcd)</div><div class="line">        &#123;</div><div class="line">            flag=<span class="number">1</span>;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> t=a2/gcd;</div><div class="line">        x=(x*(b2-b1))/gcd;</div><div class="line">        x=(x%t+t)%t;</div><div class="line">        b1=a1*x+b1;</div><div class="line">        a1=(a1*a2)/gcd;</div><div class="line">        b1=(b1%a1+a1)%a1;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (flag) <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    <span class="keyword">return</span> b1;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> (n==<span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">int</span> i;</div><div class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;b[i]);</div><div class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">        <span class="keyword">int</span> cnt=<span class="number">0</span>;</div><div class="line">        <span class="keyword">bool</span> can=<span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++) <span class="keyword">if</span> (!vis[i])</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> flag=i;</div><div class="line">            <span class="keyword">int</span> count=<span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span> (!vis[flag])</div><div class="line">            &#123;</div><div class="line">                vis[flag]=<span class="number">1</span>;</div><div class="line">                c[count++]=flag;</div><div class="line">                flag=a[flag];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> pos=<span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span> (pos&lt;count&amp;&amp;b[i]!=c[pos]) pos++;</div><div class="line">            <span class="keyword">if</span> (pos==count)</div><div class="line">            &#123;</div><div class="line">                can=<span class="literal">false</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            x[cnt]=count;</div><div class="line">            y[cnt++]=pos;</div><div class="line">            <span class="comment">//cout&lt;&lt;count&lt;&lt;" "&lt;&lt;pos&lt;&lt;endl;</span></div><div class="line">            flag=a[i];</div><div class="line">            <span class="keyword">while</span> (flag!=i)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span> (b[flag]!=c[(++pos)%count])</div><div class="line">                &#123;</div><div class="line">                    can=<span class="literal">false</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">                flag=a[flag];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (!can) <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!can) <span class="built_in">puts</span>(<span class="string">"-1"</span>);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,china_remain(cnt,x,y));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/组队训练3回放/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/组队训练3回放/" itemprop="url">
                  组队训练3回放
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T17:59:11+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>练习赛过程回放：</p>
<p>开场先看最后一题，</p>
<p>发现是专题训练时做过的网络流原题，</p>
<p>cst照着之前的打一遍，第一遍WA，</p>
<p>发现数组开小了，改大后AC。</p>
<p>这时候qw看B题，</p>
<p>一开始想不到方法，</p>
<p>cst看了下是BFS，</p>
<p>这时qw开敲，MLE。</p>
<p>然后把数组开小一位，WA。</p>
<p>后来想了想不能直接把字符串存队列里，</p>
<p>改成直接存数字，交了一发，WA。</p>
<p>然而，题目没有读清楚，不知道还能添加1，</p>
<p>修改后提交，还是WA。</p>
<p>再检查一下，没有考虑1可以加在最前面，</p>
<p>再次提交，WA。</p>
<p>考虑一下字典序的问题，发现1应该从后面开始加。</p>
<p>修改后提交，终于AC了。</p>
<p>这时cst看了下H，发现是最大团，但一开始不知道最大团的复杂度。</p>
<p>cst先建好图，然后qw把最大团模板打进去，TLE。</p>
<p>czy改成csy的模板，WA。</p>
<p>后来发现忘记开long long了，修改后AC（csy的模板太强了，速度快一倍，赶紧收藏）</p>
<p>这时候发现没题可做了，每道题都看了下，</p>
<p>qw看了下E，看到游戏的图，一开始以为是大模拟，</p>
<p>后来看了看，输入像图论，以为是最短路，</p>
<p>czy开敲，但到最后发现题目读错了，</p>
<p>再次读题，发现是dp题，</p>
<p>qw想出转移方程后开敲，AC（完全被题目误解）</p>
<p>这时候czy发现A也是dp，发现行和列本质上是一样的，</p>
<p>cst开敲，WA了几发，在这之中修改了很多细节，并且考虑了负数。</p>
<p>最后发现原来是dp数组忘记初始化了，修改后AC。</p>
<p>qw对本次比赛的总结：</p>
<p>相比之前的2次比赛，这次比赛难度大了很多，</p>
<p>但总体还行，A了5题，不过有一道题以前做过。</p>
<p>这次有点遗憾的是一道题被题目意思误导，</p>
<p>没有真正理解题意后就开始打了，导致浪费时间。</p>
<p>之后在开打前一定要完全理解题意，</p>
<p>并且知道样例是怎么推出来的，完全确定后才能开始写。</p>
<p>然后dp一般情况下都要进行初始化（就算是滚动数组），</p>
<p>之前包括个人赛，已经有几次因为dp忘记初始化导致WA。</p>
<p>几次比赛下来发现czy很适合想题。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/CSY版最大团，速度快一倍/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/CSY版最大团，速度快一倍/" itemprop="url">
                  CSY版最大团，速度快一倍
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T17:58:36+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, n)                 for(int i(0); i &lt;  (n); ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b)              for(int i(a); i &lt;= (b); ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> dec(i, a, b)              for(int i(a); i &gt;= (b); --i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> for_edge(i, x)            for(int i = H[x]; i; i = X[i])</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL      long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL     unsigned long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MP      make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PB      push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FI      first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SE      second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF     1 &lt;&lt; 30</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N     =    <span class="number">100000</span>      +       <span class="number">10</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> M     =    <span class="number">10000</span>       +       <span class="number">10</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> Q     =    <span class="number">1000</span>        +       <span class="number">10</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> A     =    <span class="number">30</span>          +       <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"></div><div class="line"><span class="keyword">int</span> T;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line">ll a[Q];</div><div class="line">ll c[Q][Q];</div><div class="line">ll mx[Q],s[Q],ans;</div><div class="line">ll f[Q][Q];</div><div class="line"><span class="keyword">int</span> i,j,k;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> cur,<span class="keyword">int</span> tot)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(!cur)&#123;</div><div class="line">        <span class="keyword">if</span>(tot&gt;ans) <span class="keyword">return</span> ans=tot,<span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j,u,nxt;i&lt;cur;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(cur-i+tot&lt;=ans) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        u=f[tot][i],nxt=<span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(mx[u]+tot&lt;=ans) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;cur;j++) </div><div class="line">        <span class="keyword">if</span>(c[u][f[tot][j]]) f[tot+<span class="number">1</span>][nxt++]=f[tot][j];</div><div class="line">        <span class="keyword">if</span>(dfs(nxt,tot+<span class="number">1</span>)) <span class="keyword">return</span> <span class="number">1</span>; </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T); T--; )&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">        <span class="built_in">memset</span>(c, <span class="number">0</span>, <span class="keyword">sizeof</span> c);</div><div class="line">        rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, a + i);</div><div class="line">        rep(i, <span class="number">1</span>, n - <span class="number">1</span>) rep(j, i + <span class="number">1</span>, n)&#123;</div><div class="line">            <span class="keyword">if</span> (a[i] % a[j] != <span class="number">0</span> &amp;&amp; a[j] % a[i] != <span class="number">0</span>)&#123;</div><div class="line">                c[i<span class="number">-1</span>][j<span class="number">-1</span>] = c[j<span class="number">-1</span>][i<span class="number">-1</span>] = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    <span class="comment">/*    rep(i, 1, n)&#123;</span></div><div class="line">            rep(j, 1, n) printf("%d ", c[i][j]);</div><div class="line">            putchar(10);</div><div class="line">        &#125;*/</div><div class="line">        <span class="built_in">memset</span>(mx,<span class="number">0</span>,<span class="keyword">sizeof</span>(mx));</div><div class="line">        <span class="built_in">memset</span>(s,<span class="number">0</span>,<span class="keyword">sizeof</span>(s));</div><div class="line">        ans=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(i=n<span class="number">-1</span>;~i;dfs(k,<span class="number">1</span>),mx[i--]=ans) </div><div class="line">        <span class="keyword">for</span>(k=<span class="number">0</span>,j=i+<span class="number">1</span>;j&lt;n;j++) </div><div class="line">        <span class="keyword">if</span>(c[i][j]) f[<span class="number">1</span>][k++]=j;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/组队训练2-回放-转载至cxhscst2-s-blog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/组队训练2-回放-转载至cxhscst2-s-blog/" itemprop="url">
                  组队训练2 回放(转载至cxhscst2's blog)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T17:57:58+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2017/3/4  12:00-17:00</p>
<p>Solve 9 / 13</p>
<p>Penalty 717</p>
<p>练习赛过程回放：</p>
<p>开场5分中J题签到(cst)</p>
<p>12分钟时qw签到A</p>
<p>这时qw继续开写M，WA，检查代码。</p>
<p>接着czy写B，cst在旁边检查，及时纠正可能导致爆int的错误。</p>
<p>38分钟czy交C，1Y。</p>
<p>三人一起查qw的M，43分钟时提交，2Y。</p>
<p>qw推出了E的公式，一开始WA了一发，70分钟2Y。</p>
<p>cst和czy讨论F，同时qw继续敲D， 92分钟2Y。</p>
<p>czy上来搞F，第一发WA。</p>
<p>czy下去查错，cst上来敲C(四面体体积公式)，104分钟，1Y。</p>
<p>czy改错之后，继续交了一发，OLE(交成了I题)， WA(第二发F题)</p>
<p>同时cst思考L，发现是个KM的模板题。</p>
<p>cst开敲L，124分钟，1Y。</p>
<p>czy重新做了F，第125分钟提交，3Y。</p>
<p>第二次训练cst总结：</p>
<p>第二次的AC率比第一次训练高了很多。</p>
<p>这次做的三道题都是1Y(当然题目简单，不坑也有关系)</p>
<p>两次训练下来发现qw比较适合前期主写代码。</p>
<p>因为这两次题目较简单，所以后期的情况暂时看不出来。</p>
<p>第二次训练qw总结：</p>
<p>确实，第二次的状态相比第一次好了很多。</p>
<p>不过因为题目简单，后面几道题又没有思路，所以2个小时后挂机。</p>
<p>还是有一些不应该的罚时，比如一道模拟题一开始又是n和m搞错了，所以WA了一发，没有做到1Y。</p>
<p>前期在签到时不仅要手速快，细节也要注意，避免不必要的罚时。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/codeforces-691D（数据结构）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/codeforces-691D（数据结构）/" itemprop="url">
                  codeforces 691D（数据结构）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T17:56:58+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>You are given a permutation of the numbers 1, 2, …, n and m pairs of positions (aj, bj).</p>
<p>At each step you can choose a pair from the given positions and swap the numbers in that positions. What is the lexicographically maximal permutation one can get?</p>
<p>Let p and q be two permutations of the numbers 1, 2, …, n. p is lexicographically smaller than the q if a number 1 ≤ i ≤ n exists, so pk = qk for 1 ≤ k &lt; i and pi &lt; qi.</p>
<p>Input<br>The first line contains two integers n and m (1 ≤ n, m ≤ 106) — the length of the permutation p and the number of pairs of positions.</p>
<p>The second line contains n distinct integers pi (1 ≤ pi ≤ n) — the elements of the permutation p.</p>
<p>Each of the last m lines contains two integers (aj, bj) (1 ≤ aj, bj ≤ n) — the pairs of positions to swap. Note that you are given a positions, not the values to swap.</p>
<p>Output<br>Print the only line with n distinct integers p’i (1 ≤ p’i ≤ n) — the lexicographically maximal permutation one can get.</p>
<p>Example<br>input<br>9 6<br>1 2 3 4 5 6 7 8 9<br>1 4<br>4 7<br>2 5<br>5 8<br>3 6<br>6 9<br>output<br>7 8 9 4 5 6 1 2 3</p>
<p>思路：可以先将所有可以交换的区间用并查集合并，然后用多个大根堆维护并查集的根可以的数字，最后只需依次将根可以的最小数字放到数组中即可，放一个数字则删除根元素。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line">priority_queue&lt;<span class="keyword">int</span>&gt; ans[<span class="number">1000001</span>];</div><div class="line"><span class="keyword">int</span> n,m,p[<span class="number">1000001</span>],father[<span class="number">1000001</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (father[x]==x) <span class="keyword">return</span> x;</div><div class="line">    father[x]=ask(father[x]);</div><div class="line">    <span class="keyword">return</span> father[x];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">hebin</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> p=ask(x);</div><div class="line">    <span class="keyword">int</span> q=ask(y);</div><div class="line">    <span class="keyword">if</span> (p!=q) father[p]=q;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;p[i]);</div><div class="line">        father[i]=i;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span> (m--)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> x,y;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">        hebin(x,y);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++) ans[father[ask(i)]].push(p[i]);</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>,ans[father[i]].top());</div><div class="line">        ans[father[i]].pop();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/ACM常用模板整理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/ACM常用模板整理/" itemprop="url">
                  ACM常用模板整理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T17:48:28+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>线段树单点修改区间查询<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;  </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;  </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;  </span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;  </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1  </span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">55555</span>;  </div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">segmentTree</span>&#123;</span>  </div><div class="line">    <span class="keyword">int</span> sum;  </div><div class="line">&#125;tree[maxn&lt;&lt;<span class="number">2</span>];  </div><div class="line"><span class="keyword">int</span> per[maxn];  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">PushUp</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;  </div><div class="line">    tree[rt].sum=tree[rt&lt;&lt;<span class="number">1</span>].sum+tree[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum;  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;  </div><div class="line">    <span class="keyword">if</span>(l==r)&#123;  </div><div class="line">        tree[rt].sum=per[l];  </div><div class="line">        <span class="keyword">return</span>;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">int</span> mid=(l+r)/<span class="number">2</span>;  </div><div class="line">    build(lson);  </div><div class="line">    build(rson);  </div><div class="line">    PushUp(rt);  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> add,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;  </div><div class="line">    <span class="keyword">if</span>(l==r)&#123;  </div><div class="line">        tree[rt].sum+=add;  </div><div class="line">        <span class="keyword">return</span>;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">int</span> mid=(l+r)/<span class="number">2</span>;  </div><div class="line">    <span class="keyword">if</span>(x&lt;=mid)update(x,add,lson);  </div><div class="line">    <span class="keyword">else</span> update(x,add,rson);  </div><div class="line">    PushUp(rt);  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;  </div><div class="line">    <span class="keyword">if</span>(a&lt;=l&amp;&amp;b&gt;=r)&#123;  </div><div class="line">        <span class="keyword">return</span> tree[rt].sum;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;  </div><div class="line">    <span class="keyword">int</span> mid=(l+r)/<span class="number">2</span>;  </div><div class="line">    <span class="keyword">if</span>(a&lt;=mid) ans+=query(a,b,lson);  </div><div class="line">    <span class="keyword">if</span>(b&gt;mid) ans+=query(a,b,rson);  </div><div class="line">    <span class="keyword">return</span> ans;  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> t,n,cas=<span class="number">1</span>;  </div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);  </div><div class="line">    <span class="keyword">while</span>(t--)&#123;  </div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);  </div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d:\n"</span>,cas++);  </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;  </div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;per[i]);  </div><div class="line">        &#125;  </div><div class="line">        build(<span class="number">1</span>,n,<span class="number">1</span>);  </div><div class="line">        <span class="keyword">char</span> op[<span class="number">11</span>];  </div><div class="line">        <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%s"</span>,op)!=EOF)&#123;  </div><div class="line">            <span class="keyword">if</span>(<span class="built_in">strcmp</span>(op,<span class="string">"End"</span>)==<span class="number">0</span>)<span class="keyword">break</span>;  </div><div class="line">            <span class="keyword">if</span>(<span class="built_in">strcmp</span>(op,<span class="string">"Query"</span>)==<span class="number">0</span>)&#123;  </div><div class="line">                <span class="keyword">int</span> a,b;  </div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);  </div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,query(a,b,<span class="number">1</span>,n,<span class="number">1</span>));  </div><div class="line">            &#125;  </div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">strcmp</span>(op,<span class="string">"Add"</span>)==<span class="number">0</span>)&#123;  </div><div class="line">                <span class="keyword">int</span> a,b;  </div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);  </div><div class="line">                update(a,b,<span class="number">1</span>,n,<span class="number">1</span>);  </div><div class="line">            &#125;  </div><div class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">strcmp</span>(op,<span class="string">"Sub"</span>)==<span class="number">0</span>)&#123;  </div><div class="line">                <span class="keyword">int</span> a,b;  </div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);  </div><div class="line">                update(a,-b,<span class="number">1</span>,n,<span class="number">1</span>);  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>线段树同时维护和、最大值、最小值<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 100000 + 10</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Lson L, mid, rt&lt;&lt;1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Rson mid+1, R, rt&lt;&lt;1|1</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;<span class="keyword">return</span> a&lt;b ? a : b;&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;<span class="keyword">return</span> a&gt;b ? a : b;&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> sum, Min, Max, lazy;</div><div class="line">&#125; T[maxn&lt;&lt;<span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">PushUp</span><span class="params">(<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    T[rt].sum = T[rt&lt;&lt;<span class="number">1</span>].sum + T[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum;</div><div class="line">    T[rt].Min = min(T[rt&lt;&lt;<span class="number">1</span>].Min, T[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].Min);</div><div class="line">    T[rt].Max = max(T[rt&lt;&lt;<span class="number">1</span>].Max, T[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].Max);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">PushDown</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> mid = (L + R) &gt;&gt; <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> t = T[rt].lazy;</div><div class="line">    T[rt&lt;&lt;<span class="number">1</span>].sum = t * (mid - L + <span class="number">1</span>);</div><div class="line">    T[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum = t * (R - mid);</div><div class="line">    T[rt&lt;&lt;<span class="number">1</span>].Min = T[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].Min = t;</div><div class="line">    T[rt&lt;&lt;<span class="number">1</span>].Max = T[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].Max = t;</div><div class="line">    T[rt&lt;&lt;<span class="number">1</span>].lazy = T[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].lazy = t;</div><div class="line">    T[rt].lazy = <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Build</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(L == R)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T[rt].sum);</div><div class="line">        T[rt].Min = T[rt].Max = T[rt].sum;</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid = (L + R) &gt;&gt; <span class="number">1</span>;</div><div class="line">    Build(Lson);</div><div class="line">    Build(Rson);</div><div class="line">    PushUp(rt);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l&lt;=L &amp;&amp; R&lt;=r)<span class="comment">//修改区间值</span></div><div class="line">    &#123;</div><div class="line">        T[rt].lazy = v;</div><div class="line">        T[rt].sum = v * (r- l + <span class="number">1</span>);</div><div class="line">        T[rt].Min = T[rt].Max = v;</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid = (L + R) &gt;&gt; <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(T[rt].lazy) PushDown(L, R, rt);<span class="comment">//向下更新一级</span></div><div class="line">    <span class="keyword">if</span>(r &lt;= mid) Update(l, r, v, Lson);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(l &gt; mid) Update(l, r, v, Rson);</div><div class="line">    <span class="keyword">else</span></div><div class="line">    &#123;</div><div class="line">        Update(l, mid, v, Lson);</div><div class="line">        Update(mid+<span class="number">1</span>, r, v, Rson);</div><div class="line">    &#125;</div><div class="line">    PushUp(rt);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    ifif(l&lt;=L &amp;&amp; R&lt;=r)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"(%d, %d)---Min: %d   Max: %d  Sum: %d  \n"</span>, L, R, T[rt].Min, T[rt].Max, T[rt].sum);</div><div class="line">        <span class="keyword">return</span> T[rt].sum;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid = (L + R) &gt;&gt; <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(T[rt].lazy) PushDown(L, R, rt);</div><div class="line">    <span class="keyword">if</span>(r &lt;= mid) <span class="keyword">return</span> Query(l, r, Lson);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(l &gt; mid) <span class="keyword">return</span> Query(l, r, Rson);</div><div class="line">    <span class="keyword">return</span> Query(l, mid, Lson) + Query(mid + <span class="number">1</span>, r, Rson);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> n, q;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">    Build(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</div><div class="line">    <span class="keyword">int</span> a, b, c, d;</div><div class="line">    <span class="keyword">while</span>(q--)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;c);</div><div class="line">        <span class="keyword">if</span>(a)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;d);</div><div class="line">            Update(b, c, d, <span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Query(b, c, <span class="number">1</span>, n, <span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>线段树区间取模（平方）区间查询<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1  </span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">500005</span>;  </div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">segmentTree</span>&#123;</span>  </div><div class="line">    <span class="keyword">int</span> sum,maxnum,col;  </div><div class="line">&#125;tree[maxn&lt;&lt;<span class="number">2</span>];  </div><div class="line"><span class="keyword">int</span> per[maxn],n,m;  </div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">PushUp</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;  </div><div class="line">    tree[rt].sum=tree[rt&lt;&lt;<span class="number">1</span>].sum+tree[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].sum;</div><div class="line">    tree[rt].maxnum=max(tree[rt&lt;&lt;<span class="number">1</span>].maxnum,tree[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].maxnum);  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;  </div><div class="line">    tree[rt].col=<span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(l==r)&#123;  </div><div class="line">        tree[rt].sum=per[l];  </div><div class="line">    tree[rt].maxnum=per[l];</div><div class="line">        <span class="keyword">return</span>;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;  </div><div class="line">    build(lson);  </div><div class="line">    build(rson);  </div><div class="line">    PushUp(rt);  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> add,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;  </div><div class="line">    <span class="keyword">if</span>(l==r)&#123;  </div><div class="line">        tree[rt].sum=add;  </div><div class="line">    tree[rt].maxnum=add;</div><div class="line">        <span class="keyword">return</span>;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;  </div><div class="line">    <span class="keyword">if</span>(x&lt;=mid)update(x,add,lson);  </div><div class="line">    <span class="keyword">else</span> update(x,add,rson);  </div><div class="line">    PushUp(rt);  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update2</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> mod,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;  </div><div class="line">    <span class="keyword">if</span> (tree[rt].maxnum&lt;mod) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span>(l==r)&#123;  </div><div class="line">        tree[rt].sum=tree[rt].sum%mod;  </div><div class="line">    tree[rt].maxnum=tree[rt].maxnum%mod;</div><div class="line">        <span class="keyword">return</span>;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;  </div><div class="line">    <span class="keyword">if</span>(x&lt;=mid)update2(x,mod,lson);  </div><div class="line">    <span class="keyword">else</span> update2(x,mod,rson);  </div><div class="line">    PushUp(rt);  </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;  </div><div class="line">    <span class="keyword">if</span>(a&lt;=l&amp;&amp;b&gt;=r)&#123;  </div><div class="line">        <span class="keyword">return</span> tree[rt].sum;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;  </div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;  </div><div class="line">    <span class="keyword">if</span>(a&lt;=mid) ans+=query(a,b,lson);  </div><div class="line">    <span class="keyword">if</span>(b&gt;mid) ans+=query(a,b,rson);  </div><div class="line">    <span class="keyword">return</span> ans;  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">mod</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt,<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> m)</span></span></div><div class="line">&#123;<span class="keyword">if</span> (tree[rt].maxnum&lt;m) <span class="keyword">return</span>;</div><div class="line"> <span class="keyword">if</span> (a&lt;=l&amp;&amp;r&lt;=b)</div><div class="line"> &#123;<span class="keyword">if</span> (l==r)</div><div class="line">  &#123;tree[rt].sum%=m;</div><div class="line">   tree[rt].maxnum=tree[rt].sum;</div><div class="line">   <span class="keyword">return</span>;</div><div class="line">   &#125;</div><div class="line">  <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">  <span class="keyword">if</span> (a&lt;=mid) mod(lson,a,b,m);</div><div class="line">  <span class="keyword">if</span> (b&gt;mid) mod(rson,a,b,m);</div><div class="line">  PushUp(rt);</div><div class="line">  <span class="keyword">return</span>;</div><div class="line">  &#125;</div><div class="line"> <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line"> <span class="keyword">if</span> (a&lt;=mid) mod(lson,a,b,m);</div><div class="line"> <span class="keyword">if</span> (b&gt;mid) mod(rson,a,b,m);</div><div class="line"> PushUp(rt);</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m)!=EOF)</div><div class="line"> &#123;<span class="keyword">int</span> i;</div><div class="line">  <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;per[i]);</div><div class="line">  build(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">  <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=m;i++)</div><div class="line">  &#123;<span class="keyword">int</span> op;</div><div class="line">   <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;op);</div><div class="line">   <span class="keyword">if</span> (op==<span class="number">1</span>)</div><div class="line">   &#123;<span class="keyword">int</span> l,r;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;l,&amp;r);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,query(l,r,<span class="number">1</span>,n,<span class="number">1</span>));</div><div class="line">    &#125; <span class="keyword">else</span></div><div class="line">    <span class="keyword">if</span> (op==<span class="number">2</span>)</div><div class="line">    &#123;<span class="keyword">int</span> l,r,x;</div><div class="line">     <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;l,&amp;r,&amp;x);</div><div class="line">     mod(<span class="number">1</span>,n,<span class="number">1</span>,l,r,x);</div><div class="line">     &#125; <span class="keyword">else</span></div><div class="line">    <span class="keyword">if</span> (op==<span class="number">3</span>)</div><div class="line">    &#123;<span class="keyword">int</span> k,x;</div><div class="line">     <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;k,&amp;x);</div><div class="line">     update(k,x,<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">     &#125;</div><div class="line">   &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>最短路spfa<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1000001</span>;  </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf =<span class="number">0x7ffffff</span>;  </div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">int</span> from,to,w,next;  </div><div class="line">&#125;e[<span class="number">1000001</span>];  </div><div class="line"><span class="keyword">int</span> head[maxn];  </div><div class="line"><span class="keyword">int</span> vis[maxn];  </div><div class="line"><span class="keyword">int</span> dist[maxn];  </div><div class="line"><span class="keyword">int</span> n,m,t;  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> j,<span class="keyword">int</span> w)</span>  </span></div><div class="line">&#123;  </div><div class="line">    e[t].from=i;  </div><div class="line">    e[t].to=j;  </div><div class="line">    e[t].w=w;  </div><div class="line">    e[t].next=head[i];  </div><div class="line">    head[i]=t++;  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s)</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q;  </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)  </div><div class="line">    dist[i]=inf;  </div><div class="line">    <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));  </div><div class="line">    q.push(s);  </div><div class="line">    dist[s]=<span class="number">0</span>;  </div><div class="line">    <span class="comment">//cout&lt;&lt;q.empty()&lt;&lt;endl;</span></div><div class="line">    <span class="keyword">while</span>(!q.empty())  </div><div class="line">    &#123;  <span class="keyword">int</span> u=q.front();  </div><div class="line">        q.pop();  </div><div class="line">        vis[u]=<span class="literal">false</span>;  </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i!=<span class="number">-1</span>;i=e[i].next)  </div><div class="line">        &#123;  <span class="comment">//cout&lt;&lt;i&lt;&lt;endl;</span></div><div class="line">       <span class="comment">//system("pause");</span></div><div class="line">            <span class="keyword">int</span> v=e[i].to;  </div><div class="line">            <span class="keyword">if</span>(dist[v]&gt;dist[u]+e[i].w)  </div><div class="line">            &#123;  </div><div class="line">                dist[v]=dist[u]+e[i].w;  </div><div class="line">                <span class="keyword">if</span>(!vis[v])  </div><div class="line">                &#123;  </div><div class="line">                    vis[v]=<span class="literal">true</span>;  </div><div class="line">                    q.push(v);  </div><div class="line">                &#125;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">doing</span><span class="params">()</span></span></div><div class="line">&#123;<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line"> t=<span class="number">0</span>;</div><div class="line"> <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</div><div class="line"> <span class="keyword">int</span> i;</div><div class="line"> <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=m;i++)</div><div class="line"> &#123;<span class="keyword">int</span> x,y;</div><div class="line">  <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">  add(x,y,<span class="number">1</span>);</div><div class="line">  add(y,x,<span class="number">1</span>);</div><div class="line">  &#125;</div><div class="line"> <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line"> &#123;<span class="keyword">int</span> x;</div><div class="line">  <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</div><div class="line">  <span class="keyword">if</span> (x!=<span class="number">-1</span>)</div><div class="line">  add(i,x,<span class="number">0</span>);</div><div class="line">  &#125;</div><div class="line"> spfa(<span class="number">1</span>);</div><div class="line"> <span class="keyword">if</span> (dist[n]==inf) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>); <span class="keyword">else</span></div><div class="line"> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,dist[n]);</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>  </span></div><div class="line">&#123;<span class="keyword">int</span> T;</div><div class="line"> <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line"> <span class="keyword">int</span> i;</div><div class="line"> <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=T;i++)</div><div class="line"> &#123;<span class="built_in">printf</span>(<span class="string">"Case #%d: "</span>,i);</div><div class="line">  doing();</div><div class="line">  &#125;</div><div class="line"> <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>2-SAT稳定党员<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-5</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">20020</span>;  </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">100010</span>;  </div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">int</span> to;  </div><div class="line">    <span class="keyword">int</span> next;  </div><div class="line">&#125; edge[MAXM];  </div><div class="line"><span class="keyword">int</span> head[MAXN],tot;  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span>  </span></div><div class="line">&#123;  </div><div class="line">    tot = <span class="number">0</span>;  </div><div class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span>  </span></div><div class="line">&#123;  </div><div class="line">    edge[tot].to = v;  </div><div class="line">    edge[tot].next = head[u];  </div><div class="line">    head[u] = tot++;  </div><div class="line">&#125;  </div><div class="line"><span class="keyword">bool</span> vis[MAXN];</div><div class="line"><span class="keyword">int</span> S[MAXN], top;</div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">if</span>(vis[u^<span class="number">1</span>])  </div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;  </div><div class="line">    <span class="keyword">if</span>(vis[u])  </div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;  </div><div class="line">    vis[u] = <span class="literal">true</span>;  </div><div class="line">    S[top++] = u;  </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; i != <span class="number">-1</span>; i = edge[i].next)  </div><div class="line">    &#123;  </div><div class="line">        <span class="keyword">if</span>(!dfs(edge[i].to))  </div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span>;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Twosat</span><span class="params">(<span class="keyword">int</span> n)</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="built_in">memset</span>(vis,<span class="literal">false</span>,<span class="keyword">sizeof</span>(vis));  </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">2</span>)  </div><div class="line">    &#123;  </div><div class="line">        <span class="keyword">if</span>(vis[i] || vis[i^<span class="number">1</span>])<span class="keyword">continue</span>;  </div><div class="line">        top = <span class="number">0</span>;  </div><div class="line">        <span class="keyword">if</span>(!dfs(i))  </div><div class="line">        &#123;  </div><div class="line">            <span class="keyword">while</span>(top)  </div><div class="line">            &#123;  </div><div class="line">                vis[S[--top]] = <span class="literal">false</span>;  </div><div class="line">            &#125;  </div><div class="line">            <span class="keyword">if</span>(!dfs(i^<span class="number">1</span>))  </div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">int</span> n, m;  </div><div class="line">    <span class="keyword">int</span> u, v;  </div><div class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m))  </div><div class="line">    &#123;  </div><div class="line">        init();  </div><div class="line">        <span class="keyword">while</span>(m--)  </div><div class="line">        &#123;  </div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);  </div><div class="line">            u--;  </div><div class="line">            v--;  </div><div class="line">            addedge(u,v^<span class="number">1</span>);  </div><div class="line">            addedge(v,u^<span class="number">1</span>);  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">if</span>(Twosat(<span class="number">2</span>*n))  </div><div class="line">        &#123;  </div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>*n; i++)  </div><div class="line">            &#123;  </div><div class="line">                <span class="keyword">if</span>(vis[i])  </div><div class="line">                &#123;  </div><div class="line">                    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i+<span class="number">1</span>);  </div><div class="line">                &#125;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">else</span>  </div><div class="line">            <span class="built_in">printf</span>(<span class="string">"NIE\n"</span>);  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>欧几里得与扩展欧几里得<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">GCD</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a,<span class="keyword">long</span> <span class="keyword">long</span> b)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span> a;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">return</span> GCD(b,a%b);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ExGCD</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a,<span class="keyword">long</span> <span class="keyword">long</span> b,<span class="keyword">long</span> <span class="keyword">long</span> &amp;d,<span class="keyword">long</span> <span class="keyword">long</span> &amp;x,<span class="keyword">long</span> <span class="keyword">long</span> &amp;y)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>( !b )</div><div class="line">    &#123;</div><div class="line">        x = <span class="number">1</span>;</div><div class="line">        y = <span class="number">0</span>;</div><div class="line">        d = a;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span></div><div class="line">    &#123;</div><div class="line">        ExGCD(b,a%b,d,y,x);</div><div class="line">        y -= x * (a/b);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>中国剩余定理<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;<span class="keyword">int</span> p,e,i,d,n;</div><div class="line"> <span class="keyword">int</span> num=<span class="number">1</span>;</div><div class="line"> <span class="keyword">int</span> tot;</div><div class="line"> <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;tot);</div><div class="line"> <span class="keyword">int</span> t;</div><div class="line"> <span class="keyword">for</span> (t=<span class="number">1</span>;t&lt;=tot;t++)</div><div class="line"> &#123;<span class="keyword">while</span> (<span class="literal">true</span>)</div><div class="line"> &#123;<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;p,&amp;e,&amp;i,&amp;d);</div><div class="line">  <span class="keyword">if</span> (p!=<span class="number">-1</span>)</div><div class="line">  &#123;n=(<span class="number">5544</span>*p+<span class="number">14421</span>*e+<span class="number">1288</span>*i-d)%<span class="number">21252</span>;</div><div class="line">   <span class="keyword">if</span> (n&lt;=<span class="number">0</span>) n+=<span class="number">21252</span>;</div><div class="line">   <span class="built_in">printf</span>(<span class="string">"Case %d: the next triple peak occurs in %d days.\n"</span>,num++,n);</div><div class="line">   &#125;</div><div class="line">  <span class="keyword">else</span> <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line"> &#125;</div><div class="line"> <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>字典树<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">char</span> c[<span class="number">11</span>];</div><div class="line"><span class="keyword">int</span> t=<span class="number">0</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ss</span></span></div><div class="line">&#123;<span class="keyword">int</span> num;</div><div class="line"> ss *a[<span class="number">27</span>];</div><div class="line"> &#125;;</div><div class="line">ss *root,memory[<span class="number">1000000</span>];</div><div class="line"><span class="built_in">string</span> s;</div><div class="line"><span class="function">ss *<span class="title">create</span><span class="params">()</span></span></div><div class="line">&#123;ss *p=&amp;memory[t++];</div><div class="line"> <span class="keyword">int</span> i;</div><div class="line"> <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;<span class="number">27</span>;i++)</div><div class="line"> p-&gt;a[i]=<span class="literal">NULL</span>;</div><div class="line"> p-&gt;num=<span class="number">0</span>;</div><div class="line"> <span class="keyword">return</span> p;</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span></span></div><div class="line">&#123;<span class="keyword">int</span> i,len=s.size();</div><div class="line"> ss *tt,*p=root;</div><div class="line"> <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;len;i++)</div><div class="line"> &#123;<span class="keyword">int</span> pos=s[i]-<span class="string">'a'</span>;</div><div class="line">  <span class="keyword">if</span> (p-&gt;a[pos]==<span class="literal">NULL</span>)</div><div class="line">  &#123;tt=create();</div><div class="line">   p-&gt;a[pos]=tt;</div><div class="line">   &#125; </div><div class="line">   p=p-&gt;a[pos];</div><div class="line">   p-&gt;num++;</div><div class="line">  &#125;</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">()</span></span></div><div class="line">&#123;<span class="keyword">int</span> i,len=s.size();</div><div class="line"> ss *p=root;</div><div class="line"> <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;len;i++)</div><div class="line"> &#123;<span class="keyword">char</span> pos=s[i]-<span class="string">'a'</span>;</div><div class="line">  <span class="keyword">if</span> (p-&gt;a[pos]==<span class="literal">NULL</span>)</div><div class="line">  &#123;<span class="built_in">puts</span>(<span class="string">"0"</span>);</div><div class="line">   <span class="keyword">return</span>;</div><div class="line">   &#125;</div><div class="line">  p=p-&gt;a[pos];</div><div class="line">  &#125;</div><div class="line"> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,p-&gt;num);</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;gets(c);</div><div class="line"> root=create();</div><div class="line"> <span class="keyword">while</span> (<span class="built_in">strlen</span>(c)!=<span class="number">0</span>)</div><div class="line"> &#123;s.assign(c);</div><div class="line">  insert();</div><div class="line">  gets(c);</div><div class="line">  &#125;</div><div class="line"> <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%s\n"</span>,&amp;c)!=EOF)</div><div class="line"> &#123;s.assign(c);</div><div class="line">  search();</div><div class="line">  &#125;</div><div class="line"><span class="keyword">return</span> <span class="number">0</span>;</div></pre></td></tr></table></figure></p>
<p>匈牙利算法<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> <span class="built_in">map</span>[<span class="number">102</span>][<span class="number">102</span>],visit[<span class="number">102</span>],match[<span class="number">102</span>];</div><div class="line"><span class="keyword">int</span> n,m,k;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span></span></div><div class="line">&#123;</div><div class="line">   <span class="keyword">int</span> x,y;</div><div class="line">&#125;rc[<span class="number">102</span>*<span class="number">102</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> k)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(visit[i]||!<span class="built_in">map</span>[k][i])</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        visit[i]=<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(!match[i]||DFS(match[i]))</div><div class="line">        &#123;</div><div class="line">             match[i]=k;</div><div class="line">             <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">    </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Match</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">         <span class="built_in">memset</span>(match,<span class="number">0</span>,<span class="keyword">sizeof</span>(match));</div><div class="line">         <span class="keyword">int</span> cnt=<span class="number">0</span>;</div><div class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">         &#123;</div><div class="line">            <span class="built_in">memset</span>(visit,<span class="number">0</span>,<span class="keyword">sizeof</span>(visit));</div><div class="line">            <span class="keyword">if</span>(DFS(i)) cnt++;</div><div class="line">         &#125;</div><div class="line">    <span class="keyword">return</span> cnt;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> i,t=<span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>,&amp;n,&amp;m,&amp;k)!=EOF)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">memset</span>(<span class="built_in">map</span>,<span class="number">0</span>,<span class="keyword">sizeof</span>(<span class="built_in">map</span>));</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=k;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>,&amp;rc[i].x,&amp;rc[i].y);</div><div class="line">            <span class="built_in">map</span>[rc[i].x][rc[i].y]=<span class="number">1</span>;</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> num=<span class="number">0</span>,ans;</div><div class="line">        ans=Match();</div><div class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=k;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">map</span>[rc[i].x][rc[i].y]=<span class="number">0</span>;</div><div class="line">            <span class="keyword">if</span>(ans&gt;Match()) num++;</div><div class="line">            <span class="built_in">map</span>[rc[i].x][rc[i].y]=<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">         <span class="built_in">printf</span>(<span class="string">"Board %d have %d important blanks for %d chessmen.\n"</span>,t++,num,ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>LCA Tarjan算法<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;  </span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;  </span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;  </span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;  </span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;  </div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span>  MAXN 1001  </span></div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line"><span class="keyword">int</span> fa[MAXN];  </div><div class="line"></div><div class="line"><span class="keyword">int</span> ques[MAXN][MAXN];  </div><div class="line"></div><div class="line"><span class="keyword">int</span> ind[MAXN];  </div><div class="line"></div><div class="line"><span class="keyword">bool</span> vis[MAXN];  </div><div class="line"></div><div class="line"><span class="keyword">int</span> cnt[MAXN];  </div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;edge[MAXN];  </div><div class="line"></div><div class="line"><span class="keyword">int</span> n,m;  </div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_father</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;  </div><div class="line"></div><div class="line">    <span class="keyword">if</span>(fa[k] == k)<span class="keyword">return</span> k;  </div><div class="line"></div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> fa[k] = find_father(fa[k]);  </div><div class="line"></div><div class="line">&#125;  </div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;  </div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;  </div><div class="line"></div><div class="line">        <span class="keyword">if</span> (vis[i] &amp;&amp; ques[x][i])  </div><div class="line"></div><div class="line">            cnt[find_father(i)] += ques[x][i];  </div><div class="line"></div><div class="line">    &#125;  </div><div class="line"></div><div class="line">    fa[x] = x;  </div><div class="line"></div><div class="line">    vis[x] = <span class="literal">true</span>;  </div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;edge[x].size(); i++) &#123;  </div><div class="line"></div><div class="line">        tarjan(edge[x][i]);  </div><div class="line"></div><div class="line">        fa[edge[x][i]] = x;  </div><div class="line"></div><div class="line">    &#125;  </div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line">&#125;  </div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;  </div><div class="line"></div><div class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n)) &#123;  </div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;  </div><div class="line"></div><div class="line">            edge[i].clear();  </div><div class="line"></div><div class="line">        &#125;  </div><div class="line"></div><div class="line">        <span class="built_in">memset</span>(ques, <span class="number">0</span>, <span class="keyword">sizeof</span>(ques));  </div><div class="line"></div><div class="line">        <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span>(vis));  </div><div class="line"></div><div class="line">        <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="keyword">sizeof</span>(cnt));  </div><div class="line"></div><div class="line">        <span class="built_in">memset</span>(ind, <span class="number">0</span>, <span class="keyword">sizeof</span>(ind));  </div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line">        <span class="keyword">int</span> a, b;  </div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;  </div><div class="line"></div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d:(%d)"</span>, &amp;a, &amp;m);  </div><div class="line"></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;m; j++) &#123;  </div><div class="line"></div><div class="line">                <span class="built_in">scanf</span>(<span class="string">" %d"</span>, &amp;b);  </div><div class="line"></div><div class="line">                edge[a].push_back(b);  </div><div class="line"></div><div class="line">                ind[b]++;  </div><div class="line"></div><div class="line">            &#125;  </div><div class="line"></div><div class="line">        &#125;  </div><div class="line"></div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);  </div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;m; i++) &#123;  </div><div class="line"></div><div class="line">            <span class="built_in">scanf</span>(<span class="string">" (%d %d)"</span>, &amp;a, &amp;b);  </div><div class="line"></div><div class="line">            ques[a][b]++;  </div><div class="line"></div><div class="line">            ques[b][a]++;  </div><div class="line"></div><div class="line">        &#125;  </div><div class="line"></div><div class="line">  </div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)  </div><div class="line"></div><div class="line">            <span class="keyword">if</span> (!ind[i]) &#123;  </div><div class="line"></div><div class="line">                tarjan(i); <span class="keyword">break</span>;  </div><div class="line"></div><div class="line">            &#125;  </div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)  </div><div class="line"></div><div class="line">            <span class="keyword">if</span> (cnt[i]) <span class="built_in">printf</span>(<span class="string">"%d:%d\n"</span>, i, cnt[i]);  </div><div class="line"></div><div class="line">    &#125;  </div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Tarjan强连通分量<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 5010<span class="comment">//题目中可能的最大点数</span></span></div><div class="line"></div><div class="line"><span class="keyword">int</span> STACK[M],top=<span class="number">0</span>;<span class="comment">//Tarjan算法中的栈</span></div><div class="line"></div><div class="line"><span class="keyword">bool</span> InStack[M];<span class="comment">//检查是否在栈中</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> DFN[M];<span class="comment">//深度优先搜索访问次序</span></div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line"><span class="keyword">int</span> Low[M];<span class="comment">//能追溯到的最早的次序</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> ComponentNumber=<span class="number">0</span>;<span class="comment">//有向图强连通分量个数</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> Index=<span class="number">0</span>;<span class="comment">//索引号</span></div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Edge[M];<span class="comment">//邻接表表示</span></div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Component[M];<span class="comment">//获得强连通分量结果</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> InComponent[M];<span class="comment">//记录每个点在第几号强连通分量里</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> ComponentDegree[M];<span class="comment">//记录每个强连通分量的度</span></div><div class="line"></div><div class="line"> </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tarjan</span><span class="params">(<span class="keyword">int</span> i)</span></span></div><div class="line"></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> j;</div><div class="line"></div><div class="line">    DFN[i]=Low[i]=Index++;</div><div class="line"></div><div class="line">    InStack[i]=<span class="literal">true</span>;STACK[++top]=i;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> e=<span class="number">0</span>;e&lt;Edge[i].size();e++)</div><div class="line"></div><div class="line">    &#123;</div><div class="line"></div><div class="line">        j=Edge[i][e];</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (DFN[j]==<span class="number">-1</span>)</div><div class="line"></div><div class="line">        &#123;</div><div class="line"></div><div class="line">            Tarjan(j);</div><div class="line"></div><div class="line">            Low[i]=min(Low[i],Low[j]);</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">else</span></div><div class="line"></div><div class="line">            <span class="keyword">if</span> (InStack[j]) Low[i]=min(Low[i],Low[j]);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (DFN[i]==Low[i])</div><div class="line"></div><div class="line">    &#123;</div><div class="line"></div><div class="line">        ComponentNumber++;</div><div class="line"></div><div class="line">        <span class="keyword">do</span>&#123;</div><div class="line"></div><div class="line">            j=STACK[top--];</div><div class="line"></div><div class="line">            InStack[j]=<span class="literal">false</span>;</div><div class="line"></div><div class="line">            Component[ComponentNumber].</div><div class="line"></div><div class="line">            push_back(j);</div><div class="line"></div><div class="line">            InComponent[j]=ComponentNumber;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (j!=i);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>KMP算法<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">kmp_pre</span><span class="params">(<span class="keyword">char</span> x[], <span class="keyword">int</span> m)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    j = Next[<span class="number">0</span>] = <span class="number">-1</span>;</div><div class="line">    i = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(i &lt; m)&#123;</div><div class="line">        <span class="keyword">while</span>(<span class="number">-1</span>!=j &amp;&amp; x[i] != x[j]) j = Next[j];</div><div class="line">        Next[++i] = ++j;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> an[MAXN]; <span class="keyword">int</span> tot;</div><div class="line"><span class="function"><span class="keyword">int</span>     <span class="title">KMP_Count</span><span class="params">(<span class="keyword">char</span> x[], <span class="keyword">int</span> m, <span class="keyword">char</span> y[], <span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">    kmp_pre(x,m);</div><div class="line">    i=j=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(i&lt;n)&#123;</div><div class="line">        <span class="keyword">while</span>(<span class="number">-1</span>!=j &amp;&amp; y[i]!=x[j]) j = Next[j];</div><div class="line">        i++; j++;</div><div class="line">        <span class="keyword">if</span>(j &gt;= m)&#123;</div><div class="line">            ans ++; an[tot++] = i;</div><div class="line">            j = Next[j];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">kmp_pre</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> m)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    j = Next[<span class="number">0</span>] = <span class="number">-1</span>;</div><div class="line">    i = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(i &lt; m)&#123;</div><div class="line">        <span class="keyword">while</span>(<span class="number">-1</span>!=j &amp;&amp; x[i] != x[j]) j = Next[j];</div><div class="line">        Next[++i] = ++j;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> an[<span class="number">1000001</span>]; <span class="keyword">int</span> tot;</div><div class="line"><span class="function"><span class="keyword">int</span>     <span class="title">KMP_Count</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> m, <span class="keyword">int</span> y[], <span class="keyword">int</span> n)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    kmp_pre(x,m);</div><div class="line">    i=<span class="number">0</span>;</div><div class="line">    j=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(i&lt;n)&#123;</div><div class="line">        <span class="keyword">while</span>(<span class="number">-1</span>!=j &amp;&amp; y[i]!=x[j]) j = Next[j];</div><div class="line">        i++; j++;</div><div class="line">        <span class="keyword">if</span>(j &gt;= m)&#123;</div><div class="line">            <span class="keyword">return</span> i-m+<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>扩展KMP（最长公共前缀）<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">GetNext</span><span class="params">(<span class="keyword">char</span> *T)</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">int</span> a=<span class="number">0</span>;  </div><div class="line">    <span class="keyword">int</span> Tlen=<span class="built_in">strlen</span>(T);  </div><div class="line">    next[<span class="number">0</span>]=Tlen;  </div><div class="line">    <span class="keyword">while</span>(a&lt;Tlen<span class="number">-1</span>&amp;&amp;T[a]==T[a+<span class="number">1</span>]) a++;  </div><div class="line">    next[<span class="number">1</span>]=a;  </div><div class="line">    a=<span class="number">1</span>;  </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">2</span>;k&lt;Tlen;k++)  </div><div class="line">    &#123;  </div><div class="line">        <span class="keyword">int</span> p=a+next[a]<span class="number">-1</span>,L=next[k-a];  </div><div class="line">        <span class="keyword">if</span>((k<span class="number">-1</span>)+L&gt;=p)  </div><div class="line">        &#123;  </div><div class="line">            <span class="keyword">int</span> j=(p-k+<span class="number">1</span>)&gt;<span class="number">0</span>? p-k+<span class="number">1</span>:<span class="number">0</span>;  </div><div class="line">            <span class="keyword">while</span>(k+j&lt;Tlen&amp;&amp;T[k+j]==T[j]) j++;  </div><div class="line">            next[k]=j;  </div><div class="line">            a=k;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">else</span> next[k]=L;  </div><div class="line">    &#125;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">GetExtend</span><span class="params">(<span class="keyword">char</span> *S,<span class="keyword">char</span> *T)</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">int</span> a=<span class="number">0</span>;  </div><div class="line">    GetNext(T);  </div><div class="line">    <span class="keyword">int</span> Slen=<span class="built_in">strlen</span>(S);  </div><div class="line">    <span class="keyword">int</span> Tlen=<span class="built_in">strlen</span>(T);  </div><div class="line">    <span class="keyword">int</span> MinLen=Slen&lt;Tlen? Slen:Tlen;  </div><div class="line">    <span class="keyword">while</span>(a&lt;MinLen&amp;&amp;S[a]==T[a]) a++;  </div><div class="line">    extend[<span class="number">0</span>]=a;  </div><div class="line">    a=<span class="number">0</span>;  </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;Slen;k++)  </div><div class="line">    &#123;  </div><div class="line">        <span class="keyword">int</span> p=a+extend[a]<span class="number">-1</span>,L=next[k-a];  </div><div class="line">        <span class="keyword">if</span>((k<span class="number">-1</span>)+L&gt;=p)  </div><div class="line">        &#123;  </div><div class="line">            <span class="keyword">int</span> j=(p-k+<span class="number">1</span>)&gt;<span class="number">0</span>? p-k+<span class="number">1</span>:<span class="number">0</span>;  </div><div class="line">            <span class="keyword">while</span>(k+j&lt;Slen&amp;&amp;j&lt;Tlen&amp;&amp;S[k+j]==T[j]) j++;  </div><div class="line">            extend[k]=j;  </div><div class="line">            a=k;  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">else</span> extend[k]=L;  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>数位DP<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span>  <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">int</span> dig[N];</div><div class="line">LL dp[N][<span class="number">10</span>][<span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> pre,<span class="keyword">int</span> istrue,<span class="keyword">int</span> limit)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (pos &lt; <span class="number">0</span>) <span class="keyword">return</span> istrue;</div><div class="line">    <span class="keyword">if</span> (!limit &amp;&amp; dp[pos][pre][istrue] != <span class="number">-1</span>)</div><div class="line">        <span class="keyword">return</span> dp[pos][pre][istrue];</div><div class="line">    <span class="keyword">int</span> last = limit ? dig[pos] : <span class="number">9</span>;</div><div class="line">    LL ret = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= last; i++) &#123;</div><div class="line">        ret += dfs(pos<span class="number">-1</span>,i,istrue || (pre == <span class="number">4</span> &amp;&amp; i == <span class="number">9</span>),limit &amp;&amp; (i == last));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (!limit) &#123;</div><div class="line">        dp[pos][pre][istrue] = ret;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function">LL <span class="title">solve</span><span class="params">(LL n)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (n) &#123;</div><div class="line">        dig[len++] = n % <span class="number">10</span>;</div><div class="line">        n /= <span class="number">10</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> dfs(len<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">memset</span>(dp,<span class="number">-1</span>,<span class="keyword">sizeof</span>(dp));</div><div class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</div><div class="line">    <span class="keyword">while</span> (T--) &#123;</div><div class="line">        LL n;</div><div class="line">        <span class="built_in">cin</span>&gt;&gt;n;</div><div class="line">        <span class="built_in">cout</span>&lt;&lt;solve(n)&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>组合数取模lucas<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">exp_mod</span><span class="params">(LL a, LL b, LL p)</span> </span>&#123;</div><div class="line">    LL res = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(b != <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = (res * a) % p;</div><div class="line">        a = (a*a) % p;</div><div class="line">        b &gt;&gt;= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">Comb</span><span class="params">(LL a, LL b, LL p)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(a &lt; b)   <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(a == b)  <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span>(b &gt; a - b)   b = a - b;</div><div class="line"></div><div class="line">    LL ans = <span class="number">1</span>, ca = <span class="number">1</span>, cb = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(LL i = <span class="number">0</span>; i &lt; b; ++i) &#123;</div><div class="line">        ca = (ca * (a - i))%p;</div><div class="line">        cb = (cb * (b - i))%p;</div><div class="line">    &#125;</div><div class="line">    ans = (ca*exp_mod(cb, p - <span class="number">2</span>, p)) % p;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">Lucas</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">int</span> p)</span> </span>&#123;</div><div class="line">     LL ans = <span class="number">1</span>;</div><div class="line"></div><div class="line">     <span class="keyword">while</span>(n&amp;&amp;m&amp;&amp;ans) &#123;</div><div class="line">        ans = (ans*Comb(n%p, m%p, p)) % p;</div><div class="line">        n /= p;</div><div class="line">        m /= p;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    Read();</div><div class="line">    <span class="keyword">int</span> n, m, p;</div><div class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;p)) &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, Lucas(n, m, p));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>block分块<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n,k,a[<span class="number">30009</span>],m,tot,sum[<span class="number">600009</span>],ans[<span class="number">60009</span>],pos[<span class="number">30009</span>];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ss</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> l,r,id,flag;</div><div class="line">&#125;;</div><div class="line">ss q[<span class="number">120009</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> id,<span class="keyword">int</span> flag)</span></span></div><div class="line">&#123;</div><div class="line">    q[++tot].l=l;</div><div class="line">    q[tot].r=r;</div><div class="line">    q[tot].id=id;</div><div class="line">    q[tot].flag=flag;</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(ss a,ss b)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (pos[a.l]==pos[b.l]) <span class="keyword">return</span> a.r&lt;b.r;</div><div class="line">    <span class="keyword">return</span> a.l&lt;b.l;</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n)!=EOF)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;k);</div><div class="line">        <span class="keyword">int</span> i;</div><div class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;m);</div><div class="line">        tot=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=m;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> l,r,u,v;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;l,&amp;r,&amp;u,&amp;v);</div><div class="line">            add(l,v,i,<span class="number">1</span>);</div><div class="line">            add(l,u<span class="number">-1</span>,i,<span class="number">-1</span>);</div><div class="line">            add(r+<span class="number">1</span>,v,i,<span class="number">-1</span>);</div><div class="line">            add(r+<span class="number">1</span>,u<span class="number">-1</span>,i,<span class="number">1</span>);</div><div class="line">         &#125;</div><div class="line">        <span class="keyword">int</span> block=(<span class="keyword">int</span>)<span class="built_in">sqrt</span>(n);</div><div class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++) pos[i]=(<span class="keyword">int</span>)(i<span class="number">-1</span>)/block+<span class="number">1</span>;</div><div class="line">        sort(q+<span class="number">1</span>,q+tot+<span class="number">1</span>,cmp);</div><div class="line">        <span class="keyword">int</span> l=<span class="number">1</span>,r=<span class="number">0</span>,tot2=<span class="number">0</span>;</div><div class="line">        <span class="built_in">memset</span>(sum,<span class="number">0</span>,<span class="keyword">sizeof</span>(sum));</div><div class="line">        <span class="comment">//cout&lt;&lt;tot&lt;&lt;endl;</span></div><div class="line">        <span class="built_in">memset</span>(ans,<span class="number">0</span>,<span class="keyword">sizeof</span>(ans));</div><div class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=tot;i++)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">while</span> (l&lt;q[i].l)</div><div class="line">            &#123;</div><div class="line">                sum[a[l]]--;</div><div class="line">                tot2-=sum[k-a[l]];</div><div class="line">                l++;</div><div class="line">             &#125;</div><div class="line">            <span class="keyword">while</span> (l&gt;q[i].l)</div><div class="line">            &#123;</div><div class="line">                l--;</div><div class="line">                tot2+=sum[k-a[l]];</div><div class="line">                sum[a[l]]++;</div><div class="line">             &#125;</div><div class="line">            <span class="keyword">while</span> (r&lt;q[i].r)</div><div class="line">            &#123;</div><div class="line">                r++;</div><div class="line">                tot2+=sum[k-a[r]];</div><div class="line">                sum[a[r]]++;</div><div class="line">             &#125;</div><div class="line">            <span class="keyword">while</span> (r&gt;q[i].r)</div><div class="line">            &#123;</div><div class="line">                sum[a[r]]--;</div><div class="line">                tot2-=sum[k-a[r]];</div><div class="line">                r--;</div><div class="line">             &#125;</div><div class="line">            <span class="comment">//cout&lt;&lt;tot2&lt;&lt;endl;</span></div><div class="line">            ans[q[i].id]+=q[i].flag*tot2;</div><div class="line">         &#125;</div><div class="line">        <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=m;i++) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans[i]);</div><div class="line">     &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>Heap<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span></span></div><div class="line">&#123;</div><div class="line">    int64 id,x;</div><div class="line"> &#125;;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cmp</span></span></div><div class="line">&#123;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> node &amp;a,<span class="keyword">const</span> node &amp;b)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> a.x&gt;b.x;</div><div class="line">     &#125;</div><div class="line">&#125;;</div><div class="line">priority_queue&lt;node,<span class="built_in">vector</span>&lt;node&gt;,cmp&gt; q;</div></pre></td></tr></table></figure></p>
<p>Set<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> id; <span class="keyword">int</span> num;</div><div class="line">    Node(<span class="keyword">int</span> a, <span class="keyword">int</span> b):id(a), num(b)&#123;&#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> Node&amp; T) <span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">return</span> id==T.id &amp;&amp; num == T.num;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Node&amp; T) <span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">if</span>(num != T.num) <span class="keyword">return</span> num &gt; T.num;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">return</span> id &lt; T.id;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">set</span>&lt;Node&gt; st;</div><div class="line"><span class="built_in">set</span>&lt;Node&gt; ::iterator it;</div><div class="line">st.insert(Node(i,po[i]));</div></pre></td></tr></table></figure></p>
<p>离散化<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">prepare</span><span class="params">(<span class="keyword">int</span> *x)</span> </span>&#123;</div><div class="line">    fo(i,<span class="number">1</span>,n) data[i]=x[i];</div><div class="line">    sort(data+<span class="number">1</span>,data+n+<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> m=unique(data+<span class="number">1</span>,data+n+<span class="number">1</span>)-data<span class="number">-1</span>;</div><div class="line">    fo(i,<span class="number">1</span>,n) x[i]=lower_bound(data+<span class="number">1</span>,data+m+<span class="number">1</span>,x[i])-data;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>最小费用最大流<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">10000</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">100000</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> to, next, cap, flow, cost;</div><div class="line">    <span class="keyword">int</span> x, y;</div><div class="line">&#125; edge[MAXM],HH[MAXN],MM[MAXN];</div><div class="line"><span class="keyword">int</span> head[MAXN],tol;</div><div class="line"><span class="keyword">int</span> pre[MAXN],dis[MAXN];</div><div class="line"><span class="keyword">bool</span> vis[MAXN];</div><div class="line"><span class="keyword">int</span> N, M,n,m;</div><div class="line"><span class="keyword">char</span> <span class="built_in">map</span>[MAXN][MAXN];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    N = MAXN;</div><div class="line">    tol = <span class="number">0</span>;</div><div class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> cap, <span class="keyword">int</span> cost)</span><span class="comment">//左端点，右端点，容量，花费</span></span></div><div class="line">&#123;</div><div class="line">    edge[tol]. to = v;</div><div class="line">    edge[tol]. cap = cap;</div><div class="line">    edge[tol]. cost = cost;</div><div class="line">    edge[tol]. flow = <span class="number">0</span>;</div><div class="line">    edge[tol]. next = head[u];</div><div class="line">    head[u] = tol++;</div><div class="line">    edge[tol]. to = u;</div><div class="line">    edge[tol]. cap = <span class="number">0</span>;</div><div class="line">    edge[tol]. cost = -cost;</div><div class="line">    edge[tol]. flow = <span class="number">0</span>;</div><div class="line">    edge[tol]. next = head[v];</div><div class="line">    head[v] = tol++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;q;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</div><div class="line">    &#123;</div><div class="line">        dis[i] = INF;</div><div class="line">        vis[i] = <span class="literal">false</span>;</div><div class="line">        pre[i] = <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    dis[s] = <span class="number">0</span>;</div><div class="line">    vis[s] = <span class="literal">true</span>;</div><div class="line">    q.push(s);</div><div class="line">    <span class="keyword">while</span>(!q.empty())</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> u = q.front();</div><div class="line">        q.pop();</div><div class="line">        vis[u] = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = head[u]; i != <span class="number">-1</span>; i = edge[i]. next)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> v = edge[i]. to;</div><div class="line">            <span class="keyword">if</span>(edge[i]. cap &gt; edge[i]. flow &amp;&amp;</div><div class="line">               dis[v] &gt; dis[u] + edge[i]. cost )</div><div class="line">            &#123;</div><div class="line">                dis[v] = dis[u] + edge[i]. cost;</div><div class="line">                pre[v] = i;</div><div class="line">                <span class="keyword">if</span>(!vis[v])</div><div class="line">                &#123;</div><div class="line">                    vis[v] = <span class="literal">true</span>;</div><div class="line">                    q.push(v);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(pre[t] == <span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">//返回的是最大流， cost存的是最小费用</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">minCostMaxflow</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> &amp;cost)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>;</div><div class="line">    cost = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(spfa(s,t))</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> Min = INF;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = pre[t]; i != <span class="number">-1</span>; i = pre[edge[i^<span class="number">1</span>]. to])</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(Min &gt; edge[i]. cap - edge[i]. flow)</div><div class="line">                Min = edge[i]. cap - edge[i]. flow;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = pre[t]; i != <span class="number">-1</span>; i = pre[edge[i^<span class="number">1</span>]. to])</div><div class="line">        &#123;</div><div class="line">            edge[i]. flow += Min;</div><div class="line">            edge[i^<span class="number">1</span>]. flow -= Min;</div><div class="line">            cost += edge[i]. cost * Min;</div><div class="line">        &#125;</div><div class="line">        flow += Min;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> flow;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>最大流EK<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 500</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXE 1100000</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7fffffff</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> net[MAXN],size;<span class="comment">//邻接表部分 </span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EDGE</span>&#123;</span></div><div class="line"></div><div class="line">    <span class="keyword">int</span> v,next;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> cap;<span class="comment">//容量 </span></div><div class="line"></div><div class="line">&#125;edge[MAXE];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    size=<span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(net,<span class="number">-1</span>,<span class="keyword">sizeof</span>(net));</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> cap)</span></span>&#123;<span class="comment">//加边 </span></div><div class="line"></div><div class="line">    edge[size].v=v;</div><div class="line"></div><div class="line">    edge[size].cap=cap;</div><div class="line"></div><div class="line">    edge[size].next=net[u];</div><div class="line"></div><div class="line">    net[u]=size++;</div><div class="line"></div><div class="line">    </div><div class="line"></div><div class="line">    edge[size].v=u;</div><div class="line"></div><div class="line">    edge[size].cap=<span class="number">0</span>;</div><div class="line"></div><div class="line">    edge[size].next=net[v];</div><div class="line"></div><div class="line">    net[v]=size++;</div><div class="line"></div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="keyword">int</span> pe[MAXN];<span class="comment">//记录当前点是由那条边转移过来的 </span></div><div class="line"></div><div class="line"><span class="keyword">int</span> pre[MAXN];<span class="comment">//记录前驱 </span></div><div class="line"></div><div class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;<span class="comment">//BFS所用队列 </span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">EK</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> max_flow=<span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;<span class="comment">//不停的找增广路 并进行增广 直到找不到增广路为止 </span></div><div class="line"></div><div class="line">        <span class="keyword">while</span>(!q.empty()) q.pop();</div><div class="line"></div><div class="line">        <span class="built_in">memset</span>(pre,<span class="number">-1</span>,<span class="keyword">sizeof</span>(pre));</div><div class="line"></div><div class="line">        q.push(s);</div><div class="line"></div><div class="line">        <span class="keyword">while</span>(!q.empty())&#123;<span class="comment">//BFS </span></div><div class="line"></div><div class="line">            <span class="keyword">int</span> u=q.front();</div><div class="line"></div><div class="line">            q.pop();</div><div class="line"></div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=net[u];i!=<span class="number">-1</span>;i=edge[i].next)&#123;</div><div class="line"></div><div class="line">                <span class="keyword">int</span> v=edge[i].v;</div><div class="line"></div><div class="line">                <span class="keyword">if</span>(pre[v]==<span class="number">-1</span>&amp;&amp;edge[i].cap&gt;<span class="number">0</span>)&#123;</div><div class="line"></div><div class="line">                    q.push(v);</div><div class="line"></div><div class="line">                    pre[v]=u;</div><div class="line"></div><div class="line">                    pe[v]=i;</div><div class="line"></div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(pre[t]!=<span class="number">-1</span>) <span class="keyword">break</span>;<span class="comment">//到达汇点 找到一条增广路 跳出BFS </span></div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(pre[t]==<span class="number">-1</span>) <span class="keyword">break</span>;<span class="comment">//没有找到增广路 跳出大循环 </span></div><div class="line"></div><div class="line">        <span class="keyword">int</span> aug=INF;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> v=t;v!=s;v=pre[v])&#123;<span class="comment">//找到最小的容量 aug </span></div><div class="line"></div><div class="line">            aug=min(aug,edge[pe[v]].cap);</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> v=t;v!=s;v=pre[v])&#123;</div><div class="line"></div><div class="line">            edge[pe[v]].cap-=aug;<span class="comment">//减去aug </span></div><div class="line"></div><div class="line">            edge[pe[v]^<span class="number">1</span>].cap+=aug;<span class="comment">//反向边加上aug </span></div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        max_flow+=aug;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> max_flow;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>最大流ISAP<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 500</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXE 1100000</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7fffffff</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> ne,nv,s,t;</div><div class="line"></div><div class="line"><span class="keyword">int</span> size,net[MAXN];</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EDGE</span>&#123;</span></div><div class="line"></div><div class="line">    <span class="keyword">int</span> v,next;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> cap;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> flow;</div><div class="line"></div><div class="line">&#125;edge[MAXE];</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    size=<span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(net,<span class="number">-1</span>,<span class="keyword">sizeof</span>(net));</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> cap)</span></span>&#123;</div><div class="line"></div><div class="line">    edge[size].v = v;</div><div class="line"></div><div class="line">    edge[size].cap = cap;</div><div class="line"></div><div class="line">    edge[size].flow = <span class="number">0</span>;</div><div class="line"></div><div class="line">    edge[size].next = net[u];</div><div class="line"></div><div class="line">    net[u] = size;</div><div class="line"></div><div class="line">    ++size;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    edge[size].v = u;</div><div class="line"></div><div class="line">    edge[size].cap = <span class="number">0</span>;</div><div class="line"></div><div class="line">    edge[size].flow = <span class="number">0</span>;</div><div class="line"></div><div class="line">    edge[size].next = net[v];</div><div class="line"></div><div class="line">    net[v] = size;</div><div class="line"></div><div class="line">    ++size;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">int</span> gap[MAXN];<span class="comment">//gap优化 </span></div><div class="line"></div><div class="line"><span class="keyword">int</span> dist[MAXN];<span class="comment">//距离标号 </span></div><div class="line"></div><div class="line"><span class="keyword">int</span> pre[MAXN];<span class="comment">//前驱 </span></div><div class="line"></div><div class="line"><span class="keyword">int</span> curedge[MAXN];<span class="comment">//当前弧 </span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ISAP</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> cur_flow,u,temp,neck,i;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> max_flow;</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(gap,<span class="number">0</span>,<span class="keyword">sizeof</span>(gap));</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(pre,<span class="number">-1</span>,<span class="keyword">sizeof</span>(pre));</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(dist,<span class="number">0</span>,<span class="keyword">sizeof</span>(dist));</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=nv;i++) curedge[i]=net[i];<span class="comment">//将当前弧初始话成邻接表的第一条边 </span></div><div class="line"></div><div class="line">    gap[nv]=nv;</div><div class="line"></div><div class="line">    max_flow=<span class="number">0</span>;</div><div class="line"></div><div class="line">    u=s;</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(dist[s]&lt;nv)&#123;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(u==t)&#123;<span class="comment">//找到一条增广路 </span></div><div class="line"></div><div class="line">            cur_flow=INF;</div><div class="line"></div><div class="line">            <span class="keyword">for</span>(i=s;i!=t;i=edge[curedge[i]].v)&#123;<span class="comment">//沿着增广路找到最小增广流量 </span></div><div class="line"></div><div class="line">                <span class="keyword">if</span>(cur_flow&gt;edge[curedge[i]].cap)&#123;</div><div class="line"></div><div class="line">                    neck=i;</div><div class="line"></div><div class="line">                    cur_flow=edge[curedge[i]].cap;</div><div class="line"></div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">for</span>(i=s;i!=t;i=edge[curedge[i]].v)&#123;<span class="comment">//更新 </span></div><div class="line"></div><div class="line">                temp=curedge[i];</div><div class="line"></div><div class="line">                edge[temp].cap-=cur_flow;</div><div class="line"></div><div class="line">                edge[temp].flow+=cur_flow;</div><div class="line"></div><div class="line">                temp^=<span class="number">1</span>;</div><div class="line"></div><div class="line">                edge[temp].cap+=cur_flow;</div><div class="line"></div><div class="line">                edge[temp].flow-=cur_flow;</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">            max_flow+=cur_flow;</div><div class="line"></div><div class="line">            u=neck;<span class="comment">//下次直接从关键边的u开始新一轮的增广 </span></div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(i=curedge[u];i!=<span class="number">-1</span>;i=edge[i].next)<span class="comment">//找到一条允许弧 </span></div><div class="line"></div><div class="line">            <span class="keyword">if</span>(edge[i].cap&gt;<span class="number">0</span>&amp;&amp;dist[u]==dist[edge[i].v]+<span class="number">1</span>)</div><div class="line"></div><div class="line">                <span class="keyword">break</span>;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(i!=<span class="number">-1</span>)&#123;<span class="comment">//如果找到 将u指向v </span></div><div class="line"></div><div class="line">            curedge[u]=i;</div><div class="line"></div><div class="line">            pre[edge[i].v]=u;</div><div class="line"></div><div class="line">            u=edge[i].v;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">else</span>&#123;<span class="comment">//找不到 </span></div><div class="line"></div><div class="line">            <span class="keyword">if</span>(<span class="number">0</span>==--gap[dist[u]]) <span class="keyword">break</span>;<span class="comment">//出现断层 </span></div><div class="line"></div><div class="line">            curedge[u] = net[u];<span class="comment">//把当前弧重新设为邻接表中满足要求的第一条弧</span></div><div class="line"></div><div class="line">            <span class="keyword">for</span>(temp=nv,i=net[u];i!=<span class="number">-1</span>;i=edge[i].next)</div><div class="line"></div><div class="line">                <span class="keyword">if</span>(edge[i].cap &gt; <span class="number">0</span>)</div><div class="line"></div><div class="line">                temp=temp&lt;dist[edge[i].v]?temp:dist[edge[i].v];</div><div class="line"></div><div class="line">            dist[u]=temp+<span class="number">1</span>;<span class="comment">//将这个点的距离标号设为由它出发的所有弧的终点的距离标号的最小值加1</span></div><div class="line"></div><div class="line">            ++gap[dist[u]];</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(u!=s)u=pre[u];</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> max_flow;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>最大流MCMF<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7fffffff</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1100</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXE 1100000</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> net[MAXN],size;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EDGE</span>&#123;</span></div><div class="line"></div><div class="line">    <span class="keyword">int</span> v,next;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> cap;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> cost;</div><div class="line"></div><div class="line">&#125;edge[MAXE];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line"></div><div class="line">    size=<span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(net,<span class="number">-1</span>,<span class="keyword">sizeof</span>(net));</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> cap,<span class="keyword">int</span> cost)</span></span>&#123;</div><div class="line"></div><div class="line">    edge[size].v=v;</div><div class="line"></div><div class="line">    edge[size].cap=cap;</div><div class="line"></div><div class="line">    edge[size].cost=cost;</div><div class="line"></div><div class="line">    edge[size].next=net[u];</div><div class="line"></div><div class="line">    net[u]=size++;</div><div class="line"></div><div class="line">    </div><div class="line"></div><div class="line">    edge[size].v=u;</div><div class="line"></div><div class="line">    edge[size].cap=<span class="number">0</span>;</div><div class="line"></div><div class="line">    edge[size].cost=-cost;</div><div class="line"></div><div class="line">    edge[size].next=net[v];</div><div class="line"></div><div class="line">    net[v]=size++;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> nv;<span class="comment">//点数 </span></div><div class="line"></div><div class="line"><span class="keyword">int</span> dist[MAXN];</div><div class="line"></div><div class="line"><span class="keyword">int</span> pre[MAXN];</div><div class="line"></div><div class="line"><span class="keyword">int</span> pe[MAXN];</div><div class="line"></div><div class="line"><span class="keyword">bool</span> hash[MAXN];</div><div class="line"></div><div class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;q;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(!q.empty()) q.pop();</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(hash,<span class="number">0</span>,<span class="keyword">sizeof</span>(hash));</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(pre,<span class="number">-1</span>,<span class="keyword">sizeof</span>(pre));</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=nv;i++) dist[i]=INF;</div><div class="line"></div><div class="line">    dist[s]=<span class="number">0</span>;</div><div class="line"></div><div class="line">    hash[s]=<span class="number">1</span>;</div><div class="line"></div><div class="line">    q.push(s);</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(!q.empty())&#123;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> u=q.front();</div><div class="line"></div><div class="line">        q.pop();</div><div class="line"></div><div class="line">        hash[u]=<span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=net[u];i!=<span class="number">-1</span>;i=edge[i].next)&#123;</div><div class="line"></div><div class="line">            <span class="keyword">int</span> v=edge[i].v;</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(edge[i].cap&amp;&amp;dist[v]&gt;dist[u]+edge[i].cost)&#123;</div><div class="line"></div><div class="line">                dist[v]=dist[u]+edge[i].cost;</div><div class="line"></div><div class="line">                pre[v]=u; pe[v]=i;</div><div class="line"></div><div class="line">                <span class="keyword">if</span>(hash[v]==<span class="number">0</span>)&#123;</div><div class="line"></div><div class="line">                    hash[v]=<span class="number">1</span>;</div><div class="line"></div><div class="line">                    q.push(v);</div><div class="line"></div><div class="line">                &#125;</div><div class="line"></div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(pre[t]==<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">MCMF</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t,<span class="keyword">int</span> need=<span class="number">0</span>)</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> max_flow=<span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> min_cost=<span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(spfa(s,t))&#123;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> aug=INF;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> v=t;v!=s;v=pre[v])&#123;</div><div class="line"></div><div class="line">            aug=min(aug,edge[pe[v]].cap);</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        max_flow+=aug;</div><div class="line"></div><div class="line">        min_cost+=dist[t]*aug;</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> v=t;v!=s;v=pre[v])&#123;</div><div class="line"></div><div class="line">            edge[pe[v]].cap-=aug;</div><div class="line"></div><div class="line">            edge[pe[v]^<span class="number">1</span>].cap+=aug;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(max_flow&lt;need) <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> min_cost;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>线段树区间合并<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 100001</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,mid,rt&lt;&lt;1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson mid+1,r,rt&lt;&lt;1|1</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> sum[maxn&lt;&lt;<span class="number">1</span>],lsum[maxn&lt;&lt;<span class="number">1</span>],rsum[maxn&lt;&lt;<span class="number">1</span>],n,m,lazy[maxn&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">PushUp</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> k)</span></span></div><div class="line">&#123;</div><div class="line">    lsum[rt]=lsum[rt&lt;&lt;<span class="number">1</span>];</div><div class="line">    rsum[rt]=rsum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</div><div class="line">    <span class="keyword">if</span> (lsum[rt]==k-(k&gt;&gt;<span class="number">1</span>)) lsum[rt]+=lsum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</div><div class="line">    <span class="keyword">if</span> (rsum[rt]==k&gt;&gt;<span class="number">1</span>) rsum[rt]+=rsum[rt&lt;&lt;<span class="number">1</span>];</div><div class="line">    sum[rt]=max(rsum[rt&lt;&lt;<span class="number">1</span>]+lsum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>],max(sum[rt&lt;&lt;<span class="number">1</span>],sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]));</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">PushDown</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> k)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (lazy[rt]!=<span class="number">-1</span>)</div><div class="line">    &#123;</div><div class="line">        lazy[rt&lt;&lt;<span class="number">1</span>]=lazy[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=lazy[rt];</div><div class="line">        lsum[rt&lt;&lt;<span class="number">1</span>]=rsum[rt&lt;&lt;<span class="number">1</span>]=sum[rt&lt;&lt;<span class="number">1</span>]=lazy[rt]?<span class="number">0</span>:(k-(k&gt;&gt;<span class="number">1</span>));</div><div class="line">        lsum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=rsum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=lazy[rt]?<span class="number">0</span>:(k&gt;&gt;<span class="number">1</span>);</div><div class="line">        lazy[rt]=<span class="number">-1</span>;</div><div class="line">     &#125;</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    lsum[rt]=rsum[rt]=sum[rt]=r-l+<span class="number">1</span>;</div><div class="line">    lazy[rt]=<span class="number">-1</span>;</div><div class="line">    <span class="keyword">if</span> (l==r) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">    build(lson);</div><div class="line">    build(rson);</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> w,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (l==r) <span class="keyword">return</span> l;</div><div class="line">    PushDown(rt,r-l+<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (sum[rt&lt;&lt;<span class="number">1</span>]&gt;=w) <span class="keyword">return</span> query(w,lson);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (rsum[rt&lt;&lt;<span class="number">1</span>]+lsum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]&gt;=w) <span class="keyword">return</span> mid-rsum[rt&lt;&lt;<span class="number">1</span>]+<span class="number">1</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> query(w,rson);</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> c,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">//cout&lt;&lt;l&lt;&lt;" "&lt;&lt;r&lt;&lt;" "&lt;&lt;rt&lt;&lt;endl;</span></div><div class="line">    <span class="keyword">if</span> (L&lt;=l&amp;&amp;r&lt;=R)</div><div class="line">    &#123;</div><div class="line">        lsum[rt]=rsum[rt]=sum[rt]=c?<span class="number">0</span>:r-l+<span class="number">1</span>;</div><div class="line">        lazy[rt]=c;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">     &#125;</div><div class="line">    PushDown(rt,r-l+<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (L&lt;=mid) upd(L,R,c,lson);</div><div class="line">    <span class="keyword">if</span> (R&gt;mid) upd(L,R,c,rson);</div><div class="line">    PushUp(rt,r-l+<span class="number">1</span>);</div><div class="line"> &#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m))</div><div class="line">    &#123;</div><div class="line">        build(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">        <span class="keyword">while</span> (m--)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> id;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;id);</div><div class="line">            <span class="keyword">if</span> (id==<span class="number">1</span>)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">int</span> a;</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a);</div><div class="line">                <span class="keyword">if</span> (sum[<span class="number">1</span>]&lt;a) <span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">else</span></div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">int</span> pos=query(a,<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">                    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,pos);</div><div class="line">                    upd(pos,pos+a<span class="number">-1</span>,<span class="number">1</span>,<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">                 &#125;</div><div class="line">             &#125; <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">                <span class="keyword">int</span> a,b;</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b);</div><div class="line">                upd(a,a+b<span class="number">-1</span>,<span class="number">0</span>,<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">             &#125;</div><div class="line">         &#125;</div><div class="line">     &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<p>求反素数<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> kk,<span class="keyword">long</span> <span class="keyword">long</span> num,<span class="keyword">long</span> <span class="keyword">long</span> sum,<span class="keyword">long</span> <span class="keyword">long</span> limit)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (sum&gt;k) <span class="keyword">return</span> ;</div><div class="line">    <span class="keyword">if</span> (sum==k) ans=min(ans,num);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=limit;i++) &#123;</div><div class="line">            <span class="keyword">if</span> (ans/p[kk] &lt;num || sum*(i+<span class="number">1</span>)&gt;k) <span class="keyword">break</span>;</div><div class="line">            num*=p[kk];</div><div class="line">            <span class="keyword">if</span> (k%(sum*(i+<span class="number">1</span>))==<span class="number">0</span>)</div><div class="line">                dfs(kk+<span class="number">1</span>,num,sum*(i+<span class="number">1</span>),i);</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>计算行列式<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line">   <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line">   <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line">   <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line">   <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line">   <span class="meta">#<span class="meta-keyword">define</span> LL long long</span></div><div class="line">   <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line">    LL n,m,A[<span class="number">105</span>][<span class="number">105</span>],p[<span class="number">10000</span>],pos,d[<span class="number">105</span>],r[<span class="number">105</span>],len,B[<span class="number">105</span>][<span class="number">105</span>];</div><div class="line">    <span class="keyword">bool</span> vd[<span class="number">10005</span>]=&#123;<span class="number">0</span>&#125;;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prime</span><span class="params">()</span></span></div><div class="line">   &#123;</div><div class="line">       pos=<span class="number">0</span>;</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;<span class="number">10005</span>;i++)</div><div class="line">       &#123;</div><div class="line">           <span class="keyword">if</span>(!vd[i])</div><div class="line">           &#123;</div><div class="line">              <span class="keyword">if</span>(i&gt;<span class="number">1000</span>) p[pos++]=i;</div><div class="line">               <span class="keyword">for</span>(<span class="keyword">int</span> j=(i&lt;&lt;<span class="number">1</span>);j&lt;<span class="number">10005</span>;j+=i)</div><div class="line">                   vd[i]=<span class="number">1</span>;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">void</span> <span class="title">deal</span><span class="params">(LL k)</span></span></div><div class="line">   &#123;</div><div class="line">       len=<span class="number">0</span>;</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;pos&amp;&amp;k!=<span class="number">1</span>;i++)</div><div class="line">       &#123;</div><div class="line">           <span class="keyword">if</span>(k%p[i]==<span class="number">0</span>)</div><div class="line">           &#123;</div><div class="line">               <span class="keyword">while</span>(k%p[i]==<span class="number">0</span>)</div><div class="line">               &#123;</div><div class="line">                   d[len++]=p[i];</div><div class="line">                   k/=p[i];</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="function">LL <span class="title">exp</span><span class="params">(LL a,LL b,LL mod)</span></span></div><div class="line">   &#123;</div><div class="line">       LL ans=<span class="number">1</span>;</div><div class="line">       <span class="keyword">while</span>(b)</div><div class="line">       &#123;</div><div class="line">           <span class="keyword">if</span>(b&amp;<span class="number">1</span>)ans=ans*a%mod;</div><div class="line">           a=a*a%mod;b&gt;&gt;=<span class="number">1</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> ans;</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">void</span> <span class="title">ex_gcd</span><span class="params">(LL a,LL b,LL &amp;dd,LL &amp;x,LL &amp;y)</span></span></div><div class="line">   &#123;</div><div class="line">       <span class="keyword">if</span>(b==<span class="number">0</span>)</div><div class="line">           x=<span class="number">1</span>,y=<span class="number">0</span>,dd=a;</div><div class="line">       <span class="keyword">else</span></div><div class="line">       &#123;</div><div class="line">           ex_gcd(b,a%b,dd,y,x);</div><div class="line">           y-=x*(a/b);</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">   <span class="function">LL <span class="title">gauss</span><span class="params">(LL mod)</span></span></div><div class="line">   &#123;</div><div class="line">       <span class="keyword">bool</span> flag=<span class="number">0</span>;</div><div class="line">       LL ans=<span class="number">1</span>;</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)</div><div class="line">               B[i][j]=A[i][j];</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;n<span class="number">-1</span>;k++)</div><div class="line">       &#123;</div><div class="line">           LL max_b=B[k][k];<span class="keyword">int</span> bin=k;</div><div class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> i=k+<span class="number">1</span>;i&lt;n;i++)</div><div class="line">               <span class="keyword">if</span>(B[i][k]&gt;max_b)</div><div class="line">                   max_b=B[i][k],bin=i;</div><div class="line">           <span class="keyword">if</span>(bin!=k)</div><div class="line">           &#123;</div><div class="line">               <span class="keyword">for</span>(<span class="keyword">int</span> i=k;i&lt;n;i++)</div><div class="line">                   swap(B[bin][i],B[k][i]);</div><div class="line">               flag^=<span class="number">1</span>;</div><div class="line">           &#125;</div><div class="line">           <span class="keyword">if</span>(B[k][k]&lt;<span class="number">0</span>)B[k][k]+=mod;</div><div class="line">           LL Ni,y,dd;</div><div class="line">           ex_gcd(B[k][k],mod,dd,Ni,y);</div><div class="line">           Ni%=mod;</div><div class="line">           <span class="keyword">if</span>(Ni&lt;<span class="number">0</span>)Ni+=mod;</div><div class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> j=k+<span class="number">1</span>;j&lt;n;j++)</div><div class="line">           &#123;</div><div class="line">               B[k][j]=B[k][j]*Ni%mod;</div><div class="line">               <span class="keyword">if</span>(B[k][j]&lt;<span class="number">0</span>)B[k][j]+=mod;</div><div class="line">               <span class="keyword">for</span>(<span class="keyword">int</span> i=k+<span class="number">1</span>;i&lt;n;i++)</div><div class="line">               &#123;</div><div class="line">                   B[i][j]=(B[i][j]-(B[k][j]*B[i][k])%mod)%mod;</div><div class="line">                   <span class="keyword">if</span>(B[i][j]&lt;<span class="number">0</span>)B[i][j]+=mod;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">           ans*=B[k][k];</div><div class="line">           ans%=mod;</div><div class="line">           <span class="keyword">if</span>(ans&lt;<span class="number">0</span>)ans+=mod;</div><div class="line">       &#125;</div><div class="line">       ans*=B[n<span class="number">-1</span>][n<span class="number">-1</span>];</div><div class="line">       ans%=mod;</div><div class="line">       <span class="keyword">if</span>(flag)ans=-ans;</div><div class="line">       <span class="keyword">if</span>(ans&lt;<span class="number">0</span>)ans+=mod;</div><div class="line">       <span class="keyword">return</span> ans;</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   <span class="function">LL <span class="title">china_remain</span><span class="params">()</span></span></div><div class="line">   &#123;</div><div class="line">       LL a,b,c,c1,c2,x,y,dd,N;</div><div class="line">       a=d[<span class="number">0</span>],c1=r[<span class="number">0</span>];</div><div class="line">       <span class="keyword">if</span>(c1==<span class="number">0</span>)c1=d[<span class="number">0</span>];</div><div class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len;i++)</div><div class="line">       &#123;</div><div class="line">           b=d[i],c2=r[i];</div><div class="line">           ex_gcd(a,b,dd,x,y);</div><div class="line">           c=c2-c1;</div><div class="line">           LL b1=b/dd;</div><div class="line">           x=((c/dd*x)%b1+b1)%b1;</div><div class="line">           c1=a*x+c1;</div><div class="line">           a=a*b1;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> c1%m;</div><div class="line">   &#125;</div><div class="line">   <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">   &#123;</div><div class="line">       prime();</div><div class="line">       <span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m)</div><div class="line">       &#123;</div><div class="line">           deal(m);</div><div class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</div><div class="line">               <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)</div><div class="line">                   <span class="built_in">cin</span>&gt;&gt;A[i][j];</div><div class="line">           <span class="keyword">if</span>(m==<span class="number">1</span>)</div><div class="line">           &#123;</div><div class="line">               <span class="built_in">cout</span>&lt;&lt;<span class="number">0</span>&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">               <span class="keyword">continue</span>;</div><div class="line">           &#125;</div><div class="line">           <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</div><div class="line">           &#123;</div><div class="line">               r[i]=gauss(d[i]);</div><div class="line">           &#125;</div><div class="line">           <span class="built_in">cout</span>&lt;&lt;china_remain()&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> <span class="number">0</span>;</div></pre></td></tr></table></figure></p>
<p>读入挂<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">scan</span><span class="params">(<span class="keyword">int</span> &amp;num)</span></span>&#123;</div><div class="line">        <span class="keyword">bool</span> isN = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">char</span> in = getchar();</div><div class="line">        <span class="keyword">if</span> (in == EOF) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">while</span> (in != <span class="string">'-'</span> &amp;&amp; ((in &lt; <span class="string">'0'</span>) || in &gt; <span class="string">'9'</span>)) in = getchar();</div><div class="line">        <span class="keyword">if</span> (in == <span class="string">'-'</span>) isN = <span class="literal">true</span>, num = <span class="number">0</span>; <span class="keyword">else</span> num = in - <span class="string">'0'</span>;</div><div class="line">        <span class="keyword">while</span> (in = getchar(), in &gt;= <span class="string">'0'</span> &amp;&amp; in &lt;= <span class="string">'9'</span>) num *= <span class="number">10</span>, num += in - <span class="string">'0'</span>;</div><div class="line">        <span class="keyword">if</span> (isN) num = -num;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">scan_lf</span><span class="params">(<span class="keyword">double</span> &amp;num)</span></span>&#123;</div><div class="line">        <span class="keyword">double</span> Dec = <span class="number">0.1</span>;</div><div class="line">        <span class="keyword">bool</span> isN = <span class="literal">false</span>, isD = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">char</span> in = getchar();</div><div class="line">        <span class="keyword">if</span> (in == EOF) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">while</span> (in != <span class="string">'-'</span> &amp;&amp; in != <span class="string">'.'</span> &amp;&amp; (in &lt; <span class="string">'0'</span> || in &gt; <span class="string">'9'</span>)) in = getchar();</div><div class="line">        <span class="keyword">if</span> (in == <span class="string">'-'</span>) isN = <span class="literal">true</span>, num = <span class="number">0</span>; <span class="keyword">else</span></div><div class="line">        <span class="keyword">if</span> (in == <span class="string">'.'</span>) isD = <span class="literal">true</span>, num = <span class="number">0</span>; <span class="keyword">else</span> num = in - <span class="string">'0'</span>;</div><div class="line">        <span class="keyword">if</span> (!isD) <span class="keyword">while</span> (in = getchar(), in &gt;= <span class="string">'0'</span> &amp;&amp; in &lt;= <span class="string">'9'</span>) num *= <span class="number">10</span>, num += in - <span class="string">'0'</span>;</div><div class="line">        <span class="keyword">if</span> (in != <span class="string">'.'</span>)&#123; <span class="keyword">if</span> (isN) num = -num; <span class="keyword">return</span> <span class="literal">true</span>;&#125; </div><div class="line">        <span class="keyword">else</span>&#123; <span class="keyword">while</span> (in = getchar(), in &gt;= <span class="string">'0'</span> &amp;&amp; in &lt;= <span class="string">'9'</span>) num += Dec * (in - <span class="string">'0'</span>), Dec *= <span class="number">0.1</span>;&#125;</div><div class="line">        <span class="keyword">if</span> (isN) num = -num;      </div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/HDU4542-小明系列故事——未知剩余系/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/HDU4542-小明系列故事——未知剩余系/" itemprop="url">
                  HDU4542 小明系列故事——未知剩余系
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T17:47:37+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>题意：给一系列操作，每个操作有两个数t和k，t=0表示求k以内的最大反素数；t=1表示求小于k且与k互质的数的个数。</p>
<p> 分析：对第一个操作，直接用dfs求反素数就行了，直接上反素数的模板；第二个操作素数筛法的思想预先打个表。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 60001</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf (1ll&lt;&lt;62)</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> _,type,k,np[maxn],ans,ca=<span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> p[] = &#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>&#125;;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> kk,<span class="keyword">long</span> <span class="keyword">long</span> num,<span class="keyword">long</span> <span class="keyword">long</span> sum,<span class="keyword">long</span> <span class="keyword">long</span> limit)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (sum&gt;k) <span class="keyword">return</span> ;</div><div class="line">    <span class="keyword">if</span> (sum==k) ans=min(ans,num);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=limit;i++) &#123;</div><div class="line">            <span class="keyword">if</span> (ans/p[kk] &lt;num || sum*(i+<span class="number">1</span>)&gt;k) <span class="keyword">break</span>;</div><div class="line">            num*=p[kk];</div><div class="line">            <span class="keyword">if</span> (k%(sum*(i+<span class="number">1</span>))==<span class="number">0</span>)</div><div class="line">                dfs(kk+<span class="number">1</span>,num,sum*(i+<span class="number">1</span>),i);</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;_);</div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;maxn;i++) np[i]=i;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;maxn;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span> (j=i;j&lt;maxn;j+=i) np[j]--;</div><div class="line">        <span class="keyword">if</span> (!np[np[i]]) np[np[i]]=i;</div><div class="line">        np[i]=<span class="number">0</span>;</div><div class="line">     &#125;</div><div class="line">    <span class="comment">//for (i=1;i&lt;=100;i++) cout&lt;&lt;np[i]&lt;&lt;endl;</span></div><div class="line">    <span class="keyword">while</span> (_--)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;type,&amp;k);</div><div class="line">        <span class="keyword">if</span> (type==<span class="number">1</span>) ans=np[k]; <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            ans=inf;</div><div class="line">            dfs(<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">62</span>);</div><div class="line">         &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %lld: "</span>,++ca);</div><div class="line">        <span class="keyword">if</span> (ans==<span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">"Illegal"</span>); <span class="keyword">else</span> <span class="keyword">if</span> (ans&gt;=inf) <span class="built_in">puts</span>(<span class="string">"INF"</span>); <span class="keyword">else</span></div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</div><div class="line">     &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/压位的高精度大数模板/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/压位的高精度大数模板/" itemprop="url">
                  压位的高精度大数模板
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T17:46:45+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line">  </div><div class="line">  </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> power = <span class="number">4</span>;      <span class="comment">//每次运算的位数为10的power次方，在这里定义为了方便程序实现  </span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> base = <span class="number">10000</span>;      <span class="comment">//10的power次方。  </span></div><div class="line">  </div><div class="line">  </div><div class="line"><span class="comment">//要压位的时候，只需改power 和 base即可，如压万位高精，那么power = 4, base = 10000  </span></div><div class="line">  </div><div class="line">  </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">10001</span>;    <span class="comment">//数组的长度。  </span></div><div class="line">  </div><div class="line">  </div><div class="line"><span class="keyword">char</span> a[MAXL], b[MAXL], aa[MAXL];  </div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">num</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">int</span> a[MAXL];  </div><div class="line">    num() &#123; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a)); &#125;                      <span class="comment">//初始化  </span></div><div class="line">    num(<span class="keyword">char</span> *s)                                            <span class="comment">//将一个字符串初始化为高精度数  </span></div><div class="line">    &#123;  </div><div class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));  </div><div class="line">        <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);  </div><div class="line">        a[<span class="number">0</span>] = (len+power<span class="number">-1</span>) / power;                       <span class="comment">//数的长度  </span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>, t=<span class="number">0</span>, w; i &lt; len ;w *= <span class="number">10</span>, ++i)          </div><div class="line">        &#123;  </div><div class="line">            <span class="keyword">if</span> (i % power == <span class="number">0</span>) &#123; w = <span class="number">1</span>, ++t; &#125;  </div><div class="line">            a[t] += w * (s[i]-<span class="string">'0'</span>);  </div><div class="line">        &#125;  </div><div class="line">        <span class="comment">//初始化数组，这里自己模拟一下，应该很容易懂的~  </span></div><div class="line">    &#125;  </div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123; <span class="keyword">if</span> (k || a[<span class="number">0</span>]) a[ ++a[<span class="number">0</span>] ] = k; &#125;     <span class="comment">//在末尾添加一个数，除法的时候要用到  </span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">re</span><span class="params">()</span> </span>&#123; reverse(a+<span class="number">1</span>, a+a[<span class="number">0</span>]+<span class="number">1</span>); &#125;                   <span class="comment">//把数反过来，除法的时候要用到  </span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span>                                            <span class="comment">//打印此高精度数  </span></span></div><div class="line">    &#123;  </div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, a[ a[<span class="number">0</span>] ]);        </div><div class="line">        <span class="comment">//先打印最高位，为了压位 或者 该高精度数为0 考虑  </span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = a[<span class="number">0</span>]<span class="number">-1</span>;i &gt; <span class="number">0</span>;--i)  </div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%0*d"</span>, power, a[i]);    </div><div class="line">        <span class="comment">//这里"%0*d", power的意思是，必须输出power位，不够则前面用0补足  </span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);  </div><div class="line">    &#125;  </div><div class="line">&#125; p,q,ans,r;  </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> num &amp;p, <span class="keyword">const</span> num &amp;q)              <span class="comment">//判断小于关系，除法的时候有用  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">if</span> (p.a[<span class="number">0</span>] &lt; q.a[<span class="number">0</span>]) <span class="keyword">return</span> <span class="literal">true</span>;  </div><div class="line">    <span class="keyword">if</span> (p.a[<span class="number">0</span>] &gt; q.a[<span class="number">0</span>]) <span class="keyword">return</span> <span class="literal">false</span>;  </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = p.a[<span class="number">0</span>];i &gt; <span class="number">0</span>;--i)  </div><div class="line">    &#123;  </div><div class="line">        <span class="keyword">if</span> (p.a[i] != q.a[i]) <span class="keyword">return</span> p.a[i] &lt; q.a[i];  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">num <span class="keyword">operator</span> + (<span class="keyword">const</span> num &amp;p, <span class="keyword">const</span> num &amp;q)               <span class="comment">//加法，不用多说了吧，模拟一遍，很容易懂  </span></div><div class="line">&#123;  </div><div class="line">    num c;  </div><div class="line">    c.a[<span class="number">0</span>] = max(p.a[<span class="number">0</span>], q.a[<span class="number">0</span>]);  </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= c.a[<span class="number">0</span>];++i)  </div><div class="line">    &#123;  </div><div class="line">        c.a[i] += p.a[i] + q.a[i];  </div><div class="line">        c.a[i+<span class="number">1</span>] += c.a[i] / base;  </div><div class="line">        c.a[i] %= base;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">if</span> (c.a[ c.a[<span class="number">0</span>]+<span class="number">1</span> ]) ++c.a[<span class="number">0</span>];  </div><div class="line">    <span class="keyword">return</span> c;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">num <span class="keyword">operator</span> - (<span class="keyword">const</span> num &amp;p, <span class="keyword">const</span> num &amp;q)               <span class="comment">//减法，也不用多说，模拟一遍，很容易懂  </span></div><div class="line">&#123;  </div><div class="line">    num c = p;  </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= c.a[<span class="number">0</span>];++i)  </div><div class="line">    &#123;  </div><div class="line">        c.a[i] -= q.a[i];  </div><div class="line">        <span class="keyword">if</span> (c.a[i] &lt; <span class="number">0</span>) &#123; c.a[i] += base; --c.a[i+<span class="number">1</span>]; &#125;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">while</span> (c.a[<span class="number">0</span>] &gt; <span class="number">0</span> &amp;&amp; !c.a[ c.a[<span class="number">0</span>] ]) --c.a[<span class="number">0</span>];            </div><div class="line">    <span class="comment">//我的习惯是如果该数为0，那么他的长度也是0，方便比较大小和在末尾添加数时的判断。  </span></div><div class="line">    <span class="keyword">return</span> c;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">num <span class="keyword">operator</span> * (<span class="keyword">const</span> num &amp;p, <span class="keyword">const</span> num &amp;q)                   </div><div class="line"><span class="comment">//乘法，还是模拟一遍。。其实高精度就是模拟人工四则运算！  </span></div><div class="line">&#123;  </div><div class="line">    num c;  </div><div class="line">    c.a[<span class="number">0</span>] = p.a[<span class="number">0</span>]+q.a[<span class="number">0</span>]<span class="number">-1</span>;  </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= p.a[<span class="number">0</span>];++i)  </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= q.a[<span class="number">0</span>];++j)  </div><div class="line">    &#123;  </div><div class="line">        c.a[i+j<span class="number">-1</span>] += p.a[i]*q.a[j];  </div><div class="line">        c.a[i+j] += c.a[i+j<span class="number">-1</span>] / base;  </div><div class="line">        c.a[i+j<span class="number">-1</span>] %= base;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">if</span> (c.a[ c.a[<span class="number">0</span>]+<span class="number">1</span> ]) ++c.a[<span class="number">0</span>];  </div><div class="line">    <span class="keyword">return</span> c;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line">  </div><div class="line">num <span class="keyword">operator</span> / (<span class="keyword">const</span> num &amp;p, <span class="keyword">const</span> num &amp;q)               <span class="comment">//除法，这里我稍微讲解一下  </span></div><div class="line">&#123;  </div><div class="line">    num x, y;  </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = p.a[<span class="number">0</span>];i &gt;= <span class="number">1</span>;--i)                       <span class="comment">//从最高位开始取数  </span></div><div class="line">    &#123;  </div><div class="line">        y.add(p.a[i]);             <span class="comment">//把数添到末尾（最低位），这时候是高位在前，低位在后  </span></div><div class="line">        y.re();                    <span class="comment">//把数反过来，变为统一的存储方式：低位在前，高位在后  </span></div><div class="line">        <span class="keyword">while</span> ( !(y &lt; q) )         <span class="comment">//大于等于除数的时候，如果小于的话，其实答案上的该位就是初始的“0”  </span></div><div class="line">            y = y - q, ++x.a[i];   <span class="comment">//看能减几个除数，减几次，答案上该位就加几次。  </span></div><div class="line">        y.re();                    <span class="comment">//将数反过来，为下一次添数做准备  </span></div><div class="line">    &#125;  </div><div class="line">    x.a[<span class="number">0</span>] = p.a[<span class="number">0</span>];  </div><div class="line">    <span class="keyword">while</span> (x.a[<span class="number">0</span>] &gt; <span class="number">0</span> &amp;&amp; !x.a[x.a[<span class="number">0</span>]]) --x.a[<span class="number">0</span>];  </div><div class="line">    <span class="keyword">return</span> x;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>  </span></div><div class="line">&#123;  </div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</div><div class="line">    &#123;<span class="keyword">char</span> flag1=getchar();</div><div class="line">     <span class="keyword">if</span> (flag1==<span class="string">'0'</span>) <span class="keyword">break</span>;</div><div class="line">     <span class="built_in">scanf</span>(<span class="string">"%s"</span>,&amp;a);</div><div class="line">     <span class="keyword">char</span> flag2=getchar();</div><div class="line">     <span class="keyword">while</span> (flag2==<span class="string">' '</span>) flag2=getchar();</div><div class="line">     <span class="built_in">scanf</span>(<span class="string">"%s\n"</span>,&amp;b);</div><div class="line">     <span class="built_in">memset</span>(aa,<span class="number">0</span>,<span class="keyword">sizeof</span>(aa));</div><div class="line">     aa[<span class="number">0</span>]=<span class="string">'0'</span>;</div><div class="line">     <span class="comment">//cout&lt;&lt;a&lt;&lt;" "&lt;&lt;b&lt;&lt;endl;</span></div><div class="line">     reverse(a,a+<span class="built_in">strlen</span>(a));</div><div class="line">     reverse(b,b+<span class="built_in">strlen</span>(b));</div><div class="line">     reverse(aa,aa+<span class="built_in">strlen</span>(aa));</div><div class="line">     p=num(a);</div><div class="line">     q=num(b);</div><div class="line">     r=num(aa);</div><div class="line">     <span class="keyword">if</span> (flag1==<span class="string">'+'</span>&amp;&amp;flag2==<span class="string">'+'</span>)</div><div class="line">     &#123;<span class="keyword">if</span> (q&lt;p)</div><div class="line">      &#123;ans=p-q;</div><div class="line">       ans.print();</div><div class="line">       &#125; <span class="keyword">else</span></div><div class="line">      &#123;ans=q-p;</div><div class="line">       <span class="keyword">if</span> (r&lt;ans)</div><div class="line">       <span class="built_in">printf</span>(<span class="string">"-"</span>);</div><div class="line">       ans.print();</div><div class="line">       &#125;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (flag1==<span class="string">'+'</span>&amp;&amp;flag2==<span class="string">'-'</span>)</div><div class="line">      &#123;ans=p+q;</div><div class="line">       ans.print();</div><div class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (flag1==<span class="string">'-'</span>&amp;&amp;flag2==<span class="string">'+'</span>)</div><div class="line">      &#123;ans=p+q;</div><div class="line">       <span class="keyword">if</span> (r&lt;ans)</div><div class="line">       <span class="built_in">printf</span>(<span class="string">"-"</span>);</div><div class="line">       ans.print();</div><div class="line">       &#125; <span class="keyword">else</span></div><div class="line">      &#123;<span class="keyword">if</span> (q&lt;p)</div><div class="line">       &#123;ans=p-q;</div><div class="line">    <span class="keyword">if</span> (r&lt;ans)</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"-"</span>);</div><div class="line">    ans.print();</div><div class="line">        &#125; <span class="keyword">else</span></div><div class="line">       &#123;ans=q-p;</div><div class="line">    ans.print();</div><div class="line">        &#125;</div><div class="line">       &#125;</div><div class="line">      &#125;</div><div class="line">   <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/Codeforces-777D-Cloud-of-Hashtags-贪心/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/Codeforces-777D-Cloud-of-Hashtags-贪心/" itemprop="url">
                  Codeforces 777D Cloud of Hashtags(贪心)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T17:44:13+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Vasya is an administrator of a public page of organization “Mouse and keyboard” and his everyday duty is to publish news from the world of competitive programming. For each news he also creates a list of hashtags to make searching for a particular topic more comfortable. For the purpose of this problem we define hashtag as a string consisting of lowercase English letters and exactly one symbol ‘#’ located at the beginning of the string. The length of the hashtag is defined as the number of symbols in it without the symbol ‘#’.</p>
<p>The head administrator of the page told Vasya that hashtags should go in lexicographical order (take a look at the notes section for the definition).</p>
<p>Vasya is lazy so he doesn’t want to actually change the order of hashtags in already published news. Instead, he decided to delete some suffixes (consecutive characters at the end of the string) of some of the hashtags. He is allowed to delete any number of characters, even the whole string except for the symbol ‘#’. Vasya wants to pick such a way to delete suffixes that the total number of deleted symbols is minimum possible. If there are several optimal solutions, he is fine with any of them.</p>
<p>Input<br>The first line of the input contains a single integer n (1 ≤ n ≤ 500 000) — the number of hashtags being edited now.</p>
<p>Each of the next n lines contains exactly one hashtag of positive length.</p>
<p>It is guaranteed that the total length of all hashtags (i.e. the total length of the string except for characters ‘#’) won’t exceed 500 000.</p>
<p>Output<br>Print the resulting hashtags in any of the optimal solutions.</p>
<p>Examples<br>input<br>3</p>
<p>#book</p>
<p>#bigtown</p>
<p>#big<br>output</p>
<p>#b</p>
<p>#big</p>
<p>#big<br>input<br>3</p>
<p>#book</p>
<p>#cool</p>
<p>#cold<br>output</p>
<p>#book</p>
<p>#co</p>
<p>#cold<br>input<br>4</p>
<p>#car</p>
<p>#cart</p>
<p>#art</p>
<p>#at<br>output<br>#<br>#</p>
<p>#art</p>
<p>#at<br>input<br>3</p>
<p>#apple</p>
<p>#apple</p>
<p>#fruit<br>output</p>
<p>#apple</p>
<p>#apple</p>
<p>#fruit<br>Note<br>Word a1, a2, …, am of length m is lexicographically not greater than word b1, b2, …, bk of length k, if one of two conditions hold: </p>
<p>at first position i, such that ai ≠ bi, the character ai goes earlier in the alphabet than character bi, i.e. a has smaller character than bin the first position where they differ;<br>if there is no such position i and m ≤ k, i.e. the first word is a prefix of the second or two words are equal.<br>The sequence of words is said to be sorted in lexicographical order if each word (except the last one) is lexicographically not greater than the next word.</p>
<p>For the words consisting of lowercase English letters the lexicographical order coincides with the alphabet word order in the dictionary.</p>
<p>According to the above definition, if a hashtag consisting of one character ‘#’ it is lexicographically not greater than any other valid hashtag. That’s why in the third sample we can’t keep first two hashtags unchanged and shorten the other two.</p>
<p>题目还是比较简单的。考虑一个单词删掉得越多，在字典里面的顺序越前面。因此可以从后忘前扫，每个单词尽可能删掉最少使之小于下一个单词。当然在比赛时太依赖STL中的erase了，所以FST了。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n,len=<span class="number">0</span>;</div><div class="line"><span class="built_in">string</span> s[<span class="number">500001</span>],ans[<span class="number">500001</span>];</div><div class="line"><span class="keyword">char</span> c[<span class="number">500001</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,c);</div><div class="line">        s[i].assign(c);</div><div class="line">    &#125;</div><div class="line">    ans[n]=s[n];</div><div class="line">    <span class="keyword">for</span> (i=n<span class="number">-1</span>;i&gt;=<span class="number">1</span>;i--)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> (s[i]&lt;=ans[i+<span class="number">1</span>]) </div><div class="line">        &#123;</div><div class="line">            ans[i]=s[i];</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> j,p;</div><div class="line">        <span class="keyword">for</span> (j=<span class="number">0</span>;j&lt;s[i].size();j++)</div><div class="line">            <span class="keyword">if</span> (s[i][j]&gt;ans[i+<span class="number">1</span>][j])</div><div class="line">            &#123;</div><div class="line">                p=j;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        ans[i]=<span class="string">""</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;p;k++) ans[i]+=s[i][k];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,ans[i].c_str());</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/Codeforces-761E（DFS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hnqw1214">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="acmclub.win">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/Codeforces-761E（DFS/" itemprop="url">
                  Codeforces 761E（DFS)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T16:42:03+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Dasha decided to have a rest after solving the problem. She had been ready to start her favourite activity — origami, but remembered the puzzle that she could not solve.<br>The tree is a non-oriented connected graph without cycles. In particular, there always are n - 1 edges in a tree with n vertices.</p>
<p>The puzzle is to position the vertices at the points of the Cartesian plane with integral coordinates, so that the segments between the vertices connected by edges are parallel to the coordinate axes. Also, the intersection of segments is allowed only at their ends. Distinct vertices should be placed at different points. </p>
<p>Help Dasha to find any suitable way to position the tree vertices on the plane.</p>
<p>It is guaranteed that if it is possible to position the tree vertices on the plane without violating the condition which is given above, then you can do it by using points with integral coordinates which don’t exceed 1018 in absolute value.</p>
<p>Input<br>The first line contains single integer n (1 ≤ n ≤ 30) — the number of vertices in the tree. </p>
<p>Each of next n - 1 lines contains two integers ui, vi (1 ≤ ui, vi ≤ n) that mean that the i-th edge of the tree connects vertices ui and vi.</p>
<p>It is guaranteed that the described graph is a tree.</p>
<p>Output<br>If the puzzle doesn’t have a solution then in the only line print “NO”.</p>
<p>Otherwise, the first line should contain “YES”. The next n lines should contain the pair of integers xi, yi (|xi|, |yi| ≤ 1018) — the coordinates of the point which corresponds to the i-th vertex of the tree.</p>
<p>If there are several solutions, print any of them. </p>
<p>Examples<br>input<br>7<br>1 2<br>1 3<br>2 4<br>2 5<br>3 6<br>3 7<br>output<br>YES<br>0 0<br>1 0<br>0 1<br>2 0<br>1 -1<br>-1 1<br>0 2<br>input<br>6<br>1 2<br>2 3<br>2 4<br>2 5<br>2 6<br>output<br>NO<br>input<br>4<br>1 2<br>2 3<br>3 4<br>output<br>YES<br>3 3<br>4 3<br>5 3<br>6 3</p>
<p>直接向4个方向模拟按长度从大到小DFS即可</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a[<span class="number">101</span>];</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> ansx[<span class="number">101</span>],ansy[<span class="number">101</span>];</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> p[<span class="number">41</span>];</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> d1[<span class="number">4</span>]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>&#125;;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> d2[<span class="number">4</span>]=&#123;<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>&#125;;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> fa,<span class="keyword">int</span> d,<span class="keyword">int</span> cnt)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator iter;</div><div class="line">    <span class="keyword">for</span> (iter=a[x].begin();iter!=a[x].end();iter++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> y=*iter;</div><div class="line">        <span class="keyword">if</span> (y==fa) <span class="keyword">continue</span>;</div><div class="line">        ansx[y]=ansx[x]+d1[(d+<span class="number">3</span>)%<span class="number">4</span>]*p[cnt];</div><div class="line">        ansy[y]=ansy[x]+d2[(d+<span class="number">3</span>)%<span class="number">4</span>]*p[cnt];</div><div class="line">        dfs(y,x,(d+<span class="number">3</span>)%<span class="number">4</span>,cnt<span class="number">-1</span>);</div><div class="line">        d++;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    p[<span class="number">0</span>]=<span class="number">1l</span>l;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=<span class="number">40</span>;i++) p[i]=p[i<span class="number">-1</span>]&lt;&lt;<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;n;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> x,y;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">        a[x].push_back(y);</div><div class="line">        a[y].push_back(x);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        <span class="keyword">if</span> (a[i].size()&gt;<span class="number">4</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">puts</span>(<span class="string">"NO"</span>);</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">40</span>);</div><div class="line">    <span class="built_in">puts</span>(<span class="string">"YES"</span>);</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %lld\n"</span>,ansx[i],ansy[i]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/8E9212F83525E2181D28AA0DBE0BF1D7.jpg"
               alt="hnqw1214" />
          <p class="site-author-name" itemprop="name">hnqw1214</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hnqw1214</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

</body>
</html>
